if(!this.JSON)this.JSON={};
(function(){function b(b){return 10>b?"0"+b:b}function a(b){e.lastIndex=0;return e.test(b)?'"'+b.replace(e,function(b){var i=j[b];return"string"===typeof i?i:"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function c(b,d){var i,n,k,l,e=g,j,u=d[b];u&&"object"===typeof u&&"function"===typeof u.toJSON&&(u=u.toJSON(b));"function"===typeof f&&(u=f.call(d,b,u));switch(typeof u){case "string":return a(u);case "number":return isFinite(u)?""+u:"null";case "boolean":case "null":return""+u;
case "object":if(!u)return"null";g+=h;j=[];if("[object Array]"===Object.prototype.toString.apply(u)){l=u.length;for(i=0;i<l;i+=1)j[i]=c(i,u)||"null";k=0===j.length?"[]":g?"[\n"+g+j.join(",\n"+g)+"\n"+e+"]":"["+j.join(",")+"]";g=e;return k}if(f&&"object"===typeof f){l=f.length;for(i=0;i<l;i+=1)n=f[i],"string"===typeof n&&(k=c(n,u))&&j.push(a(n)+(g?": ":":")+k)}else for(n in u)Object.hasOwnProperty.call(u,n)&&(k=c(n,u))&&j.push(a(n)+(g?": ":":")+k);k=0===j.length?"{}":g?"{\n"+g+j.join(",\n"+g)+"\n"+
e+"}":"{"+j.join(",")+"}";g=e;return k}}if("function"!==typeof Date.prototype.toJSON)Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,h,j={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},f;if("function"!==typeof JSON.stringify)JSON.stringify=function(b,a,i){var n;h=g="";if("number"===typeof i)for(n=0;n<i;n+=1)h+=" ";else"string"===typeof i&&(h=i);if((f=a)&&"function"!==typeof a&&("object"!==typeof a||"number"!==typeof a.length))throw Error("JSON.stringify");return c("",
{"":b})};if("function"!==typeof JSON.parse)JSON.parse=function(b,a){function i(b,c){var n,d,f=b[c];if(f&&"object"===typeof f)for(n in f)Object.hasOwnProperty.call(f,n)&&(d=i(f,n),void 0!==d?f[n]=d:delete f[n]);return a.call(b,c,f)}var c,b=""+b;d.lastIndex=0;d.test(b)&&(b=b.replace(d,function(b){return"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(b.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return c=eval("("+b+")"),"function"===typeof a?i({"":c},""):c;throw new SyntaxError("JSON.parse");}})();if("function"!==typeof Date.now)Date.now=function(){return(new Date).getTime()};window._previousPureDom=window.puredom;
(function(){var b=function(){return f.puredom.apply(f,arguments)},a={baseAnimationInterval:20,allowCssTransitions:!0,easingMethods:{ease:function(b){return(Math.sin(b*Math.PI-Math.PI/2)+1)/2},"ease-in-out":function(b){return(Math.sin(b*Math.PI-Math.PI/2)+1)/2},"ease-in-out-2":function(b){return this["ease-in-out"](this["ease-in-out"](b))},"ease-in-out-3":function(b){return this["ease-in-out"](this["ease-in-out"](this["ease-in-out"](b)))}}},c=!1,d,e,g=a.constructor,h,j,f={oninit:[],animationTimes:{fast:150,
medium:450,slow:1E3},animationTimeScale:1,registeredEventCount:0,html5elements:"abbr article aside audio canvas datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video".split(" "),support:{html5:!0,querySelectorAll:!!("querySelectorAll"in document),filters:!1,webkitMultitouch:!!("createTouch"in document)},regex:{css3AutoPrefix:/([\s\;\/\*])(box\-shadow|text\-shadow|border\-radius)\:([^\;]*)(\;|$)/gim,css3VendorPrefix:/\b\-(moz|webkit|ms|o|vendor)\-/gim,
templateFieldToken:/([^\\]?)\{([a-z0-9A-Z\$_\.]+)(\|[^\}]*?)?\}/gm,parseObjectNameFromString:/^\[object ([^\s]+)\]$/gim,autoDetectHTMLContent:/(<[a-z]|&[a-z#0-9]{1,10};)/gim,whitespaceCharacters:/\s/,getNumericCSSValue:/[^0-9\.\-]/gm,getCSSValueUnits:/([a-z]+|%)$/,getNonIntegerCharsSigned:/[^0-9\.\-]/gm,getUpperCaseAlphaChars:/[A-Z]/gm}};if(navigator.userAgent.match(/\b(iOS|Android|WebOS|iPhone|iPod|iPad)\b/gim))b.allowCssTransitions=!1,b.baseAnimationInterval=50,f.animationTimeScale=1.5;if(navigator.userAgent.match(/\b(webkit|applewebkit|chrome|chromium|khtml)\b/gim))d=
"-webkit",e="Webkit";else if(navigator.userAgent.match(/\bopera\b/gim))d="-o",e="O";else if(navigator.userAgent.match(/\bgecko\b/gim))d="-moz",e="Moz";else if(navigator.userAgent.match(/\bmsie\s*?(8|9|[1-9][0-9]+)\b/gim))d="-ms",e="Ms";else if(navigator.userAgent.match(/\bmsie\s*?[4-8]\b/gim))f.support.filters=!0,f.support.filterProperty="filter";(function(b,i){b=document.createElement("div");b.innerHTML="<nav></nav>";f.support.html5=0<b.childNodes.length;if(!f.support.html5){f.html5frag=document.createDocumentFragment();
for(i=f.html5elements.length;i--;)f.html5frag.createElement(f.html5elements[i]);f.html5div=document.createElement("div");f.html5frag.appendChild(f.html5div)}})();j=function(){var b=document.body;h=void 0!==b.textContent&&"textContent"||b.innerText&&"innerText"||"innerHTML";j=null;return h};b.extend=function(b){var i,a,c,b=b||{};for(i=1;i<arguments.length;i++)if(c=arguments[i]){for(a in c)c.hasOwnProperty(a)&&(b[a]=c[a]);if("function"===typeof c.toString&&c.toString!==Object.prototype.toString)b.toString=
c.toString}return b};b.mixin=function(b){var i,a,c,b=b||{};for(i=1;i<arguments.length;i++)if(c=arguments[i])for(a in c)c.hasOwnProperty(a)&&!b.hasOwnProperty(a)&&(b[a]=c[a]);return b};b.strip=function(b,i){for(var a in b)if(!0===i||b.hasOwnProperty(a))b[a]=null};b.delve=function(b,i,a,c){var d=0,i=i.split(".");for(!0===a&&i.splice(0,1);d<i.length&&b&&b.hasOwnProperty(i[d]);)b=b[i[d]],d+=1;if(d>=i.length||!0===c&&0<d)return b};b.flattenObj=function(a,i,c,k){var d,f,i=i||"",c=c||0,k=k||{};for(d in a)a.hasOwnProperty(d)&&
(f=i?i+"_"+d:d,b.isScalar(a[d])?k[f]=a[d]:b.flattenObj(a[d],f,c+1,k));if(!c)return k};b.template=function(a,i,c){var k;if(!1!==c&&b.i18n)k=b.i18n;return(a+"").replace(f.regex.templateFieldToken,function(a,c,n,d){"\\"!==c&&n?(a=b.delve(i,n))?(k&&(a=k(a)||a),d&&"|"===d.substring(0,1)&&(a=b.text.filter(a,d.substring(1))),a=c+a):a=c:a=c;return a})};b.inherits=function(b,i){function a(){}a.prototype=i.prototype;var c=b.prototype;b.prototype=new a;puredom.extend(b.prototype,c);b.prototype.constructor=b;
b.prototype.__super=i};b.typeOf=function(b){if(void 0===b)return"undefined";if(null===b)return"null";if(b){if(b.constructor===g)return"object";if("[object Array]"===Object.prototype.toString.call(b))return"array"}return Object.prototype.toString.call(b).replace(f.regex.parseObjectNameFromString,"$1").toLowerCase()};b.isScalar=function(a){a=b.typeOf(a);return"undefined"===a||"null"===a||"number"===a||"string"===a||"boolean"===a?!0:!1};if(!Array.prototype.indexOf||0!==[b].indexOf(b))try{Array.prototype.indexOf=
function(b){for(var i=0;i<this.length;i++)if(this[i]===b)return i;return-1}}catch(m){}b.toArray=function(b){var i=[],a=b&&b.length;if(a||0===a)for(;a--;)i[a]=b[a];else for(a=0;;){if(b.hasOwnProperty&&b.hasOwnProperty(a))i.push(b[a]);else if(b.hasOwnProperty&&b.hasOwnProperty(a+""))i.push(b[a+""]);else break;a+=1}return i};b.isArray=function(a){return"array"===b.typeOf(a)};b.hasOwnProperty=function(b,i){return Object.prototype.hasOwnProperty.call(b,i)};b.forEach=b.foreach=function(a,i){var c,k;if(b.isArray(a))for(c=
0;c<a.length&&!(k=i(a[c],c),!1===k);c++);else for(c in a)if(a.hasOwnProperty(c)&&(k=i(a[c],c),!1===k))break;return a};b.setInnerHTML=function(b,i){var a,c;if(f.support.html5)b.innerHTML=i||"";else{b.innerHTML="";f.html5div.innerHTML=i||"";a=document.createDocumentFragment();for(c=f.html5div.childNodes.length;c--;)a.appendChild(f.html5div.firstChild);b.appendChild(a)}};b.createElement=function(a,i){var c,k,l,e,a=a||{};c=document.createElement(a.type||"div");i=i||a.parent;if(a.insertBefore&&a.insertBefore.constructor===
b.NodeSelection)a.insertBefore=a.insertBefore._nodes[0];if(!i&&a.insertBefore)i=a.insertBefore.parentNode;for(k in a)if(b.hasOwnProperty(a,k))if("on"===(k+"").substring(0,2).toLowerCase())b.addEvent(c,k.substring(2),a[k]);else if("css"===k||"cssText"===k)d&&(a[k]=a[k].replace(f.regex.css3AutoPrefix,"$1"+d+"-$2:$3; $2:$3;"),a[k]=a[k].replace(f.regex.css3VendorPrefix,"-"+d+"-")),c.style.cssText=a[k];else if("html"===k||"innerHTML"===k)b.setInnerHTML(c,a[k]);else if("attributes"===k)for(l in a[k])b.hasOwnProperty(a[k],
l)&&c.setAttribute(l,a[k][l]);else if("parent"!==k&&"children"!==k&&"insertBefore"!==k&&"type"!==k&&"children"!==k&&"html"!==k&&"innerHTML"!==k)if(document.all)try{c[k]=a[k]}catch(g){b.log(k)}else c[k]=a[k];if(i){if(a.insertBefore)try{i.insertBefore(c,a.insertBefore),e=!0}catch(h){e=!1}e||i.appendChild(c)}if(a.children&&b.isArray(a.children)){l=document.createDocumentFragment();for(k=0;k<a.children.length;k++)b.createElement(a.children[k],l);c.appendChild(l)}return c};b.NodeSelection=function i(a){var c;
this._results=[];this._nodes=[];this._animations=[];if(a)if(b.isArray(a))for(c=0;c<a.length;c++)a[c]&&(a[c].constructor===i&&a[c]._nodes?this._nodes.push(a[c]._nodes[0]):this._nodes.push(a[c]));else this._nodes.push(a)};b.extend(b.NodeSelection.prototype,{_results:[],_nodes:[],_animations:[],describe:function(){var b=[];this.each(function(a){var c="<"+a.nodeName(),d=a.prop("id"),f=a.prop("className");d&&(c+=' id="'+d+'"');f&&(c+=' class="'+f+'"');c+=">";c=1===a._nodes[0].childNodes.length&&3===a._nodes[0].childNodes[0].nodeType?
c+a.text().replace(/(\r|\n)/gim,decodeURIComponent("%E2%86%A9")).replace(/\t/gim,decodeURIComponent("%E2%86%92")):c+("["+a.children().count()+" children]");c+="</"+a.nodeName()+">";b.push(c)});return b},toString:function(){return this.describe().join(", ")},toSource:function(){return this._nodes},getResult:function(b){b=Math.round(b)||0;return this._results[this._results.length-b-1]},pushResult:function(b){this._results.push(b);return this},each:function(b){return this._each(b,!0)},_each:function(a,
c,d){var l=this._nodes.slice(0,this._nodes.length),f,e,g;for(f=0;f<l.length;f++)e=f,!0===d&&(e=l.length-e-1),g=l[e],!0===c&&(g=new b.NodeSelection(g)),a.call(this,g,e);return this},wait:function(b,a){var c=this;a&&setTimeout(function(){a.apply(c);c=a=null},Math.abs(b));return this},nodeName:function(){var b=this._nodes[0],a=b&&b.nodeName&&b.nodeName.toLowerCase();return b===window?"#window":a?a:null},uuid:function(){return this._nodes[0]&&f.nodeToId(this._nodes[0])||null},text:function(b){if(0===
arguments.length)return this._nodes[0]&&this._nodes[0][h||j()]||"";b+="";this._each(function(a){a[h||j()]=b});return this},html:function(a,c){if(0===arguments.length)return this._nodes[0]&&this._nodes[0].innerHTML||"";a+="";f.regex.autoDetectHTMLContent.lastIndex=0;f.regex.autoDetectHTMLContent.test(a)&&!0!==c?this._each(function(c){b.setInnerHTML(c,a)}):this._each(function(b){b[h||j()]=a});return this},css:function(a,c){var d,l=this,c=c||{};d=b.typeOf(c.tween);if("string"===d&&"none"!==c.tween||
"number"===d&&0<c.tween){d=(c.tween+"").replace(f.regex.whitespaceCharacters,"").split(",");var e,g,h=0,y=0;g=function(b){y+=1;y>=h&&(g=null,c.callback&&c.callback(b),l=null)};for(e in a)a.hasOwnProperty(e)&&(h+=1,this.animateCss(e,a[e],d[0],d[1],g))}else this._each(function(c){b.applyCss(c,a)}),c.callback?setTimeout(function(){c.callback(l);l=null},1):l=null;return this},show:function(){this.css({display:"",visibility:"visible"});this._each(function(a){if("none"===a.style.display||"none"===b.nodeStyle(a,
"display"))a.style.display="block"});return this},hide:function(b){return this.css(!1===b?{visibility:"hidden"}:{display:"none"})},fadeIn:function(a,c){var d=parseFloat(this.getStyle("opacity")||"0")||0,l=1;if("none"===this.getStyle("display")||"hidden"===this.getStyle("visibility"))this.getStyle("opacity")&&0<d&&1>d&&(l=d),d=0,this.css({opacity:0});"function"===b.typeOf(a)&&(a=c=a);if(1<=d||0==a||!1===a)return this.css({opacity:l}).show(),setTimeout(c,0),this;this.css({opacity:l},{tween:a||"medium",
callback:function(b){c&&c(b);a=c=null}}).show();return this},fadeOut:function(a,c,d){var l=parseFloat(this.getStyle("opacity")||"1")||1;"function"===b.typeOf(a)&&(a=c=a);"boolean"===b.typeOf(c)&&(d=c,c=null,"function"===b.typeOf(d)&&(c=d));if(0>=l||"none"===this.getStyle("display")||"hidden"===this.getStyle("visibility")||0===a||!1===a)return this.css({opacity:0}).hide(d),setTimeout(c,0),this;this.css({opacity:0},{tween:a||"medium",callback:function(b){b.hide(d).css({opacity:l});c&&c(b);a=c=null}});
return this},animateCSS:function(){var a,c,d,l;a=function(a,c,i,d,k){var n=[],l=[],e,g,h,a=a.toLowerCase();"auto"!==c?(e=parseFloat((c+"").replace(f.regex.getNumericCSSValue,""))||0,g=(h="string"===b.typeOf(c)&&c.match(f.regex.getCSSValueUnits))&&h[0]||"px","opacity"===a&&(g="")):g="opacity"===a?"":"px";this._each(function(i,d){var k,y;k={};var h;n[d]=parseFloat((b.nodeStyle(i,a)+"").replace(f.regex.getNonIntegerCharsSigned,""))||0;if("auto"===c||""===c){h=i.style.visibility||"";k[a]=c;k.visibility=
"hidden";b.applyCss(i,k);k=b.nodeStyle(i,a);if(k===c||k.indexOf("px")<k.length-3)k=a.substring(0,1).toUpperCase()+a.substring(1).toLowerCase(),k=i["offset"+k]+"px";y="string"===b.typeOf(k)&&k.match(f.regex.getCSSValueUnits);l[d]={_actualTarget:c,numericTargetValue:parseFloat((k+"").replace(f.regex.getNumericCSSValue,""))||0,units:"opacity"===a?"":y&&y[0]||"px"};setTimeout(function(){i.style.visibility=h;i=null},51);k=k=y=null}else l[d]={numericTargetValue:e,units:g}});return this.animate(function(c){this._each(function(i,
d){var k={},f=c*(l[d].numericTargetValue-n[d])+n[d],e=l[d].units;"px"===e?f=Math.round(f):(f=parseFloat(f),f=0===f%1?Math.round(f):f.toFixed(2));k[a]=f+e;b.applyCss(i,k)})},i,d,function(c){c._each(function(c,i){var d={};if(l[i]._actualTarget)d[a]=l[i]._actualTarget,b.applyCss(c,d)});k.apply(c,arguments)})};c=function(a,c,i,d,k){var n=this._createAnimationObj(function(){},i,d,k),l=this,e={},g={},a=(a+"").replace(f.regex.getUpperCaseAlphaChars,"-$1").toLowerCase();"number"===b.typeOf(c)&&"opacity"!==
(a+"").toLowerCase()&&(c+="px");e[a]={duration:n.duration,timingFunction:n.easing};g[a]=c;setTimeout(function(){l._each(function(a){b.updateCssTransitions(a,e);b.applyCss(a,g);f.incrementAnimationCount(a)});n._cb=function(){if(n){var c={};c[a]=null;l._each(function(a){b.updateCssTransitions(a,c);f.decrementAnimationCount(a)});n.callback&&n.callback(l);for(var i in n)if(n.hasOwnProperty(i))try{delete n[i]}catch(d){}}n=g=k=l=null};setTimeout(n._cb,(parseInt(n.duration,10)||0)+20)},10)};l=function(){return d=
void 0!==document.body.style[e+"Transition"]||void 0!==document.body.style.transition};return function(f){"boolean"!==b.typeOf(d)&&l();!1!==b.allowCssTransitions&&d?c.apply(this,arguments):a.apply(this,arguments);return this}}(),animate:function(a,c,d,l){if(a){var e=this,g=this._createAnimationObj.apply(this,arguments),h;this._each(function(b){f.incrementAnimationCount(b)});h=function(a){g.frameTime=a;g.position=g.frameTime-g.start;g.fraction=g.position/g.duration;if(g.position>=g.duration)g.fraction=
1,g.position=g.duration;else if(g.easingMethod)g.fraction=g.easingMethod.call(b.easingMethods,g.fraction,g);g.animator.call(e,g.fraction,g);if(1===g.fraction){for(a=e._animations.length;a--;)if(e._animations[a]===g){e._animations.splice(a,1);break}g.callback&&setTimeout(function(){e._each(function(b){f.decrementAnimationCount(b)});g.callback.call(e,e,g);e=g=null},10)}else g.timer=b.animationFrame.getTimer(h,b.baseAnimationInterval||10)};b.animationFrame.getTimer(h,b.baseAnimationInterval||10);this._animations.push(g)}return this},
_createAnimationObj:function(a,c,d,l){a={animator:a,duration:c,easing:"string"===b.typeOf(d)?d:"ease",callback:l,start:b.animationFrame.getStartTime(),frameTime:null};if("string"===b.typeOf(a.duration))switch(a.duration.toLowerCase()){case "long":case "slow":a.duration=f.animationTimes.slow;break;case "short":case "fast":a.duration=f.animationTimes.fast;break;default:a.duration=parseInt(a.duration)||f.animationTimes.medium}else a.duration=Math.round(a.duration)||f.animationTimes.medium;f.animationTimeScale&&
(a.duration*=f.animationTimeScale);a.easing&&b.easingMethods.hasOwnProperty(a.easing)?a.easingMethod=b.easingMethods[a.easing]:a.easing=null;return a},classify:function(a){var c=[],d="{*^de^*}"===arguments[0]?"removeClass":"addClass",l,f;for(l=0;l<arguments.length;l++)if(b.isArray(arguments[l]))for(f=0;f<arguments[l].length;f++)c.push(arguments[l][f]);else c.push(arguments[l]);this._each(function(a){b[d](a,c)});return this},declassify:function(b){return this.classify.apply(this,["{*^de^*}"].concat(Array.prototype.slice.call(arguments,
0)))},hasClass:function(b,a){var c=!0!==a;this._each(function(d){d=-1<(" "+d.className+" ").indexOf(" "+b+" ");!0===a?d&&(c=!0):d||(c=!1)});return c},setOpacity:function(a){this._each(function(c){b.setOpacity(c,a)});return this},sumOf:function(a){var c=0,d=Array.prototype.slice.call(arguments,1);this.constructor.prototype.hasOwnProperty(a)&&this._each(function(l){l=new b.NodeSelection(l);c+=l[a].apply(l,d)});return c},height:function(a,c){var d,l=0;"object"===b.typeOf(a)&&!c&&(c=a,a=null);c=c||{};
if(a||0===a)return a+="","auto"===a?d="":(d=/^([\-0-9\.]+)(.*?)$/.exec(a),a=Math.round(d&&d[1]||a)||0,d=d&&d[2]||"px"),this.css({height:a+d}),this;this._each(function(a){l+=parseInt(a.offsetHeight,10)||0;!0===c.border&&(l+=parseInt((b.nodeStyle(a,"border-top-width")+"").replace(f.regex.getNonIntegerCharsSigned,""),10)||0,l+=parseInt((b.nodeStyle(a,"border-bottom-width")+"").replace(f.regex.getNonIntegerCharsSigned,""),10)||0);!0===c.margin&&(l+=parseInt((b.nodeStyle(a,"margin-top")+"").replace(f.regex.getNonIntegerCharsSigned,
""),10)||0,l+=parseInt((b.nodeStyle(a,"margin-bottom")+"").replace(f.regex.getNonIntegerCharsSigned,""),10)||0);!1===c.padding&&(l-=parseInt((b.nodeStyle(a,"padding-top")+"").replace(f.regex.getNonIntegerCharsSigned,""),10)||0,l-=parseInt((b.nodeStyle(a,"padding-bottom")+"").replace(f.regex.getNonIntegerCharsSigned,""),10)||0)});return l},width:function(a,c){var d,l=0;"object"===b.typeOf(a)&&!c&&(c=a,a=null);c=c||{};if(a||0===a)return a+="","auto"===a?d="":(a=(d=/^([\-0-9\.]+)(.*?)$/.exec(a))&&d[1]||
a,d=d&&d[2]||"px"),this.css({width:a+d}),this;this._each(function(a){l+=parseInt(a.offsetWidth,10)||0;!0===c.border&&(l+=parseInt((b.nodeStyle(a,"border-left-width")+"").replace(f.regex.getNonIntegerCharsSigned,""),10)||0,l+=parseInt((b.nodeStyle(a,"border-right-width")+"").replace(f.regex.getNonIntegerCharsSigned,""),10)||0);!0===c.margin&&(l+=parseInt((b.nodeStyle(a,"margin-left")+"").replace(f.regex.getNonIntegerCharsSigned,""),10)||0,l+=parseInt((b.nodeStyle(a,"margin-right")+"").replace(f.regex.getNonIntegerCharsSigned,
""),10)||0);!1===c.padding&&(l-=parseInt((b.nodeStyle(a,"padding-left")+"").replace(f.regex.getNonIntegerCharsSigned,""),10)||0,l-=parseInt((b.nodeStyle(a,"padding-right")+"").replace(f.regex.getNonIntegerCharsSigned,""),10)||0)});return l},x:function(b){var a=this._nodes[0],c=null;if(a&&(c=a.offsetLeft,!0===b))for(;(a=a.parentNode)&&a!==document;)c+=parseFloat(a.offsetLeft)||0;return c},y:function(b){var a=this._nodes[0],c=null;if(a&&(c=a.offsetTop,!0===b))for(;(a=a.parentNode)&&a!==document;)c+=
parseFloat(a.offsetTop)||0;return c},position:function(b,a,c,d){var f,d=d||"px";if(1>arguments.length||1===arguments.length&&!0===arguments[0])return{x:this.x(!0===arguments[0]),y:this.y(!0===arguments[0])};f={};if("number"===puredom.typeOf(b))f.left=b+d;else if("string"===puredom.typeOf(b))f.left=b;if("number"===puredom.typeOf(a))f.top=a+d;else if("string"===puredom.typeOf(a))f.top=a;this.css(f,c);return this},scrollLeft:function(a){if(a||0===a)"number"!==b.typeOf(a)&&(a=Math.round((a+"").replace(f.regex.getNonIntegerCharsSigned,
""))),this._each(function(b){b.scrollLeft=a});else return this._nodes&&this._nodes[0]&&this._nodes[0].scrollLeft||0},scrollTop:function(a){if(a||0===a)"number"!==b.typeOf(a)&&(a=Math.round((a+"").replace(f.regex.getNonIntegerCharsSigned,""))),this._each(function(b){b.scrollTop=a});else return this._nodes&&this._nodes[0]&&this._nodes[0].scrollTop||0},focus:function(){this._each(function(b){b.focus&&b.focus()});return this},blur:function(){this._each(function(b){b.blur&&b.blur()});return this},selectAll:function(){this._each(function(b){b.SelectAll&&
b.SelectAll();b.select&&b.select();if(b.selectionStart&&b.hasOwnProperty("value"))b.selectionStart=0,b.selectionEnd=b.value.length})},getStyle:function(a,c){var d=[];this._each(function(c){d.push(b.nodeStyle(c,a)||null)});return!1===c?(this.pushResult(d),this):1>=d.length?d[0]:d},value:function(a,c){c=c||{};if(null!==a&&void 0!==a&&0<arguments.length)return this._each(function(d){var k=(d.nodeName+"").toLowerCase(),f=(d.getAttribute("type")||"").toLowerCase();if("input"===k&&("checkbox"===f||"radio"===
f))d.checked=!!a;d.value=a;!1!==c.fireChange&&b.fireEvent({type:"change",target:d,value:a})}),this;var d=[];this._each(function(a){var c=(a.nodeName+"").toLowerCase(),i=(a.getAttribute("type")||"").toLowerCase(),n;"input"===c&&("checkbox"===i||"radio"===i)?d.push(!!a.checked):"select"===c?(n=a.multiselect||a.multiSelect?[]:null,b.el(a).query("option")._each(function(a){if(a.selected||a.checked)b.isArray(n)?n.push(a.value):n=a.value}),d.push(n)):d.push(a.value)});return 2>d.length?d[0]||null:d},attr:function(a,
c,d){var f=[],e,g;if(0===arguments.length){f={};for(e=this._nodes[0].attributes.length;e--;)g=this._nodes[0].attributes[e],f[g.name||g.nodeName]=g.value||g.nodeValue;return f}if(1<arguments.length){if("object"===b.typeOf(a)){for(e in a)"string"===typeof e&&a.hasOwnProperty(e)&&this.attr(f,a[e]);return this}return this._each(function(b){try{b.setAttribute(a,c),b.removeAttribute&&(null===c||void 0===c)&&b.removeAttribute(a)}catch(d){}})}this._each(function(b){b=b.getAttribute(a);"string"!==typeof b&&
(b=null);f.push(b)});return!1===d?(this.pushResult(f),this):1>=f.length?f[0]:f},prop:function(b,a,c){var d=[];if(1<arguments.length)return this._each(function(c){c[b]=a;if(void 0===a)try{delete c[b]}catch(d){}});this._each(function(a){var c;try{c=a[b]}catch(k){console.log("NodeSelection.prop("+b+") :: Access Error",k)}d.push(c||null)});return!1===c?(this.pushResult(d),this):1>=d.length?d[0]:d},enable:function(){this.attr("disabled",null);this.declassify("_puredom_disabled");return this},disable:function(){this.attr("disabled",
"disabled");this.classify("_puredom_disabled");return this},enabled:function(b){return!0===b||!1===b?(this[b?"enable":"disable"](),this):"disabled"!==this.attr("disabled")&&!0!==this.prop("disabled")&&!this.hasClass("_puredom_disabled")},addEvent:function(a,c,d){this._each(function(f){b.addEvent(f,a,c,d)});return this},removeEvent:function(a,c,d){this._each(function(f){b.removeEvent(f,a,c,d)});return this},fireEvent:function(a,c){this._each(function(d){b.fireEvent(b.extend({},c||{},{type:a,target:d}))});
return this},_removeAllEvents:function(b){var a;this._each(function(b){f.wrappedEventListener.destroyObjHandlers(b,!0)});a=this.children();!0===b&&0<a.count()&&a._removeAllEvents(!0);a=b=null;return this},appendChild:function(b){if(b&&0<this._nodes.length)if(b.constructor===this.constructor){var a=this._nodes[0];b._each(function(b){a.appendChild(b)})}else this._nodes[0].appendChild(b);return this},insertBefore:function(b,a){if(b&&0<this._nodes.length){a&&a.constructor===this.constructor&&(a=a._nodes[0]);
if(!a||a.parentNode!==this._nodes[0])return this.appendChild(b);if(b.constructor===this.constructor){var c=this._nodes[0];b._each(function(b){c.insertBefore(b,a)},null,!0)}else this._nodes[0].insertBefore(b,a)}return this},insertInto:function(b){var a;b&&0<this.count()&&(b.constructor===this.constructor&&(b=b._nodes[0]),1===this.count()?b.appendChild(this._nodes[0]):(a=document.createDocumentFragment(),this._each(function(b){a.appendChild(b)},null,!0),!0!==f.support.filters&&b.appendChild(a)));return this},
remove:function(){this.fireEvent("remove");this._each(function(b){b.parentNode&&b.parentNode.removeChild(b)});return this},destroy:function(){this.remove();this.fireEvent("destroy");this._removeAllEvents(!0);this._nodes.splice(0,this._nodes.length);return this},query:function(a,c){var d=[];0<this._nodes.length&&this._each(function(f){f=b.getElement(a,puredom.extend({},c||{},{within:f}));b.isArray(f)&&0<f.length&&(d=d.concat(f))});return new b.NodeSelection(d)},clone:function(a,c){var d=[];!0===c&&
(c=this.parent());this._each(function(b){d.push(b.cloneNode(!1!==a))});d=new b.NodeSelection(d);c&&c.appendChild(d);d._each(f.removeNodeUID);!1!==a&&d.query("*")._each(f.removeNodeUID);return d},count:function(){return this._nodes.length},exists:function(){return 0<this.count()},next:function(){for(var a=this._nodes[0]&&this._nodes[0].nextSibling;a&&3===a.nodeType;)a=a.nextSibling;return new b.NodeSelection(a&&[a]||null)},prev:function(){for(var a=this._nodes[0]&&this._nodes[0].previousSibling;a&&
3===a.nodeType;)a=a.previousSibling;return new b.NodeSelection(a&&[a]||null)},previous:function(){return this.prev.apply(this,arguments)},firstChild:function(){return this.children().first()},lastChild:function(){return this.children().last()},nthChild:function(b){return this.children().index(b)},first:function(a){return new b.NodeSelection(this._nodes.slice(0,a||1))},last:function(a){return new b.NodeSelection(this._nodes.slice(this._nodes.length-(a||1)))},index:function(a,c){return new b.NodeSelection("number"===
b.typeOf(a)&&this._nodes.slice(a,a+(c||1))||null)},siblings:function(){var a=new b.NodeSelection;this._each(function(b){for(var c=b;c=c.previousSibling;)"#text"!==c.nodeName&&"#comment"!==c.nodeName&&3!==c.nodeType&&a._nodes.push(c);for(c=b;c=c.nextSibling;)"#text"!==c.nodeName&&"#comment"!==c.nodeName&&3!==c.nodeType&&a._nodes.push(c)});return a},parent:function(){var a=[],c;this._each(function(b){(c=b.parentNode)&&0>a.indexOf(c)&&11!==c.nodeType&&a.push(c)});return new b.NodeSelection(a)},children:function(){var a=
[],c,d;if(0<this._nodes.length)for(c=0;c<this._nodes.length;c++)if(this._nodes[c].childNodes)for(d=0;d<this._nodes[c].childNodes.length;d++)3!==this._nodes[c].childNodes[d].nodeType&&"#text"!==this._nodes[c].childNodes[d].nodeName&&"#comment"!==this._nodes[c].childNodes[d].nodeName&&a.push(this._nodes[c].childNodes[d]);return new b.NodeSelection(a)},submit:function(){this._each(function(a){var c=b.fireEvent({type:"submit",target:a});!1!==c.rval&&!1!==c.returnValue&&!0!==c.preventDefault&&a.submit&&
a.submit()})},selection:function(a,c){var d=this._nodes[0],f,e;if(a&&"number"!==typeof a&&a.start)c=a.end,a=a.start;if("number"===typeof a)0>a&&(a=0),e=d.value.length,c>e&&(c=e),a>c?a=c:c<a&&(c=a),window.getSelection?(d.selectionStart=a,d.selectionEnd=c):d.selectionEnd||0===d.selectionEnd?(d.selectionStart=a,d.selectionEnd=c):d.createTextRange&&(d=d.createTextRange(),d.collapse(!0),d.moveStart("character",a),d.moveEnd("character",c),d.select());else{if(window.getSelection)return f="string"===typeof d.value?
d.value:d.innerHTML,e=window.getSelection(),{start:d.selectionStart+0,end:d.selectionEnd+0,text:f.substring(e.start,e.end)};if(document.selection)return e=document.selection.createRange(),f=document.body.createTextRange(),f.moveToElementText(d),f.setEndPoint("EndToStart",e),{start:f.text.length,end:f.text.length+e.text.length,text:e.text};b.log("Selection retrieval is not supported in this browser.");return{start:0,end:0,text:""}}return this},template:function(a){var c,a=a||{};c=function(b){var b=
b.split("|"),a;b.splice(0,1);for(a=b.length;a--;)"htmlEntities"===b[a]&&b.splice(a,1);return b};this.query("[data-tpl-id]").each(function(d){var f=d.nodeName(),e=d.attr("data-tpl-id"),g=e,h;h=c(e);e=e.split("|")[0];g=puredom.delve(a,e);if(null!==g&&void 0!==g){if("date"===typeof g||g.constructor===Date)g=g.toLocaleString();if(e=d.attr("data-tpl-prop"))d.prop(e,b.text.filter(g,h.join("|")));else switch(f){case "select":case "input":case "textarea":case "meter":case "progress":d.value(g);break;case "img":case "video":case "audio":case "iframe":h.splice(0,
0,"htmlEntities");g=b.text.filter(g,h.join("|"));d.attr("src",g);break;default:h.splice(0,0,"htmlEntities"),g=b.text.filter(g,h.join("|")),d.html(g)}}});a=null;return this}});b.NodeSelection.prototype.on=b.NodeSelection.prototype.addEvent;b.NodeSelection.prototype.animateCss=b.NodeSelection.prototype.animateCSS;f.incrementAnimationCount=function(a){a.setAttribute("data-puredom-animation-count",f.getAnimationCount(a)+1+"");b.addClass(a,"_puredom_animating")};f.decrementAnimationCount=function(a){var c=
Math.max(0,f.getAnimationCount(a));1<c?a.setAttribute("data-puredom-animation-count",c-1+""):(a.setAttribute("data-puredom-animation-count",""),a.removeAttribute&&a.removeAttribute("data-puredom-animation-count"),b.removeClass(a,"_puredom_animating"))};f.getAnimationCount=function(b){return parseInt(b.getAttribute("data-puredom-animation-count"),10)||0};f.unload=function(){f.wrappedEventListener.reset();b.getElement.clearCache();f._nodeToIdList={};setTimeout(function(){window.puredom=f=g=j=null},
10)};b.el=function(a,c){var d,f;if(a){f=b.typeOf(a);if("array"===f){d=[];for(var e=0;e<a.length;e++)Array.prototype.splice.apply(d,[0,0].concat(b.el(a[e])._nodes))}if(a.constructor===b.NodeSelection)return!0===c&&console.log("query is already a NodeSelection",a.constructor+"",a.constructor.name),a;if("string"===f&&"<"===a.charAt(0)||"object"===f&&!a.nodeName&&a!==window)!0===c&&console.log("query is an HTML fragment",a,f),d=b.createElement.apply(b,arguments);else if("string"===f)!0===c&&console.log("query is a CSS selector",
a,f),d=b.getElement(a,arguments[1]);else if(a.nodeName||a===window)!0===c&&console.log("query is an HTML element",a,f),d=a}return new b.NodeSelection(d)};b.node=function(a){return new b.NodeSelection(f.idToNode(a))};b.getElement=function(){var a,c,d={},e=!1,g=/^((?:[a-z][a-z0-9\_\-]*)|\*)?/gi,h=/^\s*(.*?)\s*$/gm,j;j=[{title:"ID selector {#id}",regex:/^#[_a-zA-Z0-9-]*/gm,filter:function(b,a,c){return[(c.searchBaseNode&&c.searchBaseNode.getElementById?c.searchBaseNode:document).getElementById(b[0].substring(1))]}},
{title:"Class selector {.className}",regex:/^\.([^#.:\[<>\{+\|\s]+)/gim,filter:function(b,a){var c,d,i=" "+b[1]+" ";for(c=a.length;c--;)d=a[c]&&a[c].className,(!d||-1===(" "+d+" ").indexOf(i))&&a.splice(c,1)}},{title:"Attribute selector {[name=value] & variants}",regex:/^\[([^\^\$\~=]+)(?:([\^\$\~=]+)([^\]]*))?\]/g,filter:function(a,c){var d,i,f,e,k,g,l,n;if(a&&a[1]){d=a[1];i=void 0;f=void 0;a[2]&&a[3]&&(i=a[2],f=a[3]||"");for(g=c.length;g--;){l="checked"===d?"true"===f||"false"===f?c[g].checked?
"true":"false":c[g].checked?"checked":null:"selected"===d?"true"===f||"false"===f?c[g].selected?"true":"false":c[g].selected?"selected":null:c[g]&&c[g].getAttribute(d+"");e="string"===b.typeOf(l);k=l&&0<l.length;f&&(n=e?l.indexOf(f):-1);switch(i||""){case "=":e=l===f;break;case "^=":e=0===n;break;case "$=":e=k&&l.substring(l.length-f.length)===f;break;case "~=":e=-1<n;break;default:e=!f&&e}e||c.splice(g,1)}}}},{title:"Descendant selector {>}",regex:/^\s*\>\s*((?:[a-z][a-z0-9\:\_\-]*)|\*)?/gi,filter:function(a,
c,d){var f=[].concat(c),a=(a[1]||"*").toLowerCase(),i,e,k;c.splice(0,c.length);!d.isFiltered&&d.first&&b.log("Descendant selector called on an unfiltered result set.  Operating on descendants of the document.");if(!d.isFiltered||d.first)f=[d.searchBaseNode];for(d=0;d<f.length;d++){e=f[d].childNodes;for(i=0;i<e.length;i++)k=(e[i].nodeName+"").toLowerCase(),(k===a||"*"===a&&"#"!==k.charAt(0)&&(1===e[i].nodeType||9===e[i].nodeType))&&c.push(e[i])}}},{title:"nth-child aliases, like :first-child",regex:/^\:(first|last|only)\-(child|of\-type)/gm,
filter:function(a,c,d){var i={"first-child":":nth-child(0n+1)","first-of-type":":nth-of-type(0n+1)","last-child":":nth-last-child(0n+1)","last-of-type":":nth-last-of-type(0n+1)"},f,e;for(f=j.length;f--;)if(!0===j[f].isNthChildSelector){e=j[f];break}if(i.hasOwnProperty(a[1]+"-"+a[2])&&e)return a=i[a[1]+"-"+a[2]],e.regex.lastIndex=0,a=e.regex.exec(a),e.filter(a,c,d);b.log('Unknown nth-child alias "'+a[1]+"-"+a[2]+'"')}},{isNthChildSelector:!0,title:"nth-child selector {:nth-child(n+2) & variants}",
regex:/^\:(nth(?:\-last)?(?:\-of\-type|\-child))\((?:(\-?[0-9]*n(?:[+-][0-9]+)?)|([0-9]+)|([a-z]+))\)/gm,filter:function(a,c){var d,f,i,e,k,g,l,n,h,j=-1!==a[1].indexOf("-of-type");i={odd:[2,1],even:[2]};d=c.splice(0,c.length);-1!==a[1].indexOf("-last")&&d.reverse();a[2]?(f=a[2].split("n"),0===f[0].replace("-","").length&&(f[0]+="1"),n=Math.round(f[0].replace("+",""))||0,h=Math.round(f[1].replace("+",""))||0):a[3]?(n=0,h=Math.round(a[3])||0):a[4]&&(f=a[4].toLowerCase(),i.hasOwnProperty(f)?(n=i[f][0]||
0,h=i[f][1]||0):b.log('Unknown named nth-child expression "'+r[4]+'"'));if(!(0>=n+h)){n===h&&(h=0);for(f=0;f<d.length;f++){children=(d[f].parentNode||{}).childNodes;k=(d[f].nodeName+"").toLowerCase();isMatch=!1;if(children)for(i=l=0;i<children.length;i++)if(g=children[i],e=j?(g.nodeName+"").toLowerCase()===k:"#"!==(g.nodeName+"").substring(0,1)||1===g.nodeType||9===g.nodeType)if(l+=1,g===d[f]&&(isMatch=0<n?0===l%n-h:l===h))break;isMatch&&c.push(d[f])}}}},{title:"within_internal selector { }",regex:/^\s+((?:[a-z][a-z0-9\:\_\-]*)|\*)?/gi,
filter:function(a,c){var d=[].concat(c),f=a[1]||"*",i;c.splice(0,c.length);for(i=0;i<d.length;i++)Array.prototype.splice.apply(c,[c.length-1,0].concat(b.toArray(d[i].getElementsByTagName(f))))}}];c=function(b){b.lastIndex=0};a=function(y,m){var q=document&&document.documentElement||document,o,w,B=y,D,F,s,z,E=0,G=!1;z=!f.support.querySelectorAll;var A=Date.now(),y=(y+"").replace(h,"$1"),m=puredom.extend({},m||{});!0===m.logging&&(G=!0);if(e&&!0===m.useCache&&d[y])return d[y];if(m.within)q=m.within;
q&&q.length&&!q.nodeName&&q.indexOf&&q[0]&&(q=q[0]);if(-1<y.indexOf(",")){y=y.split(",");o=[];for(s=y.length;s--;)if(y[s]=y[s].replace(h,"$1"),0<y[s].length&&(q=a(y[s],puredom.extend({},m,{logging:!1,internalLogging:G,internal:!0}))))for(w=0;w<q.length;w++)-1===o.indexOf(q[w])&&o.push(q[w]);G&&b.log("query=",B,", result=",node);A=Date.now()-A;100<A&&b.log('Slow Selector Warning: "'+B+'" took '+A+"ms to complete.");return o}w=y.match(g);w=(w&&w[0]||"").toLowerCase();s=y=y.substring(w.length);">"===
B.charAt(0)&&(z=!0);if(s.match(/^#[^\s\[\]\(\)\:\*\.\,<>#]+$/gim))o=[(q.getElementById?q:document).getElementById(s.substring(1))],z=!1;else if(f.support.querySelectorAll&&!0!==z){D=B.replace(/(\[[^\[\]= ]+=)([^\[\]"']+)(\])/gim,'$1"$2"$3');try{o=b.toArray(q.querySelectorAll(D)||[])}catch(L){console.log("Native querySelectorAll failed for selector: ",D,", error:",L.message),o=[],z=!0}}if(z){"#"===y.substring(0,1)?o=[]:(!w||"*"===w)&&document.all&&!window.opera&&(q===document||q===document.documentElement)?
(o=b.toArray(q.all||document.all),F=!1):(o=b.toArray(q.getElementsByTagName(w||"*")),F=!0);for(D={searchBaseNode:q,negated:!1,first:!0,isFiltered:F||!!(w&&"*"!==w)};0<s.length;){E+=1;z=!1;for(w=0;w<j.length;w++){c(j[w].regex);if(q=j[w].regex.exec(s))z=!0,G&&b.log((j[w].title||j[w].regex)+' ==>> matched:"'+s.substring(0,q[0].length)+'" ==>> remaining:"'+s.substring(q[0].length)+'" ||debug>> (submatches:'+q.slice(1).join(",")+")"),(F=j[w].filter(q,o,D))&&b.isArray(F)&&(o=F),s=s.substring(q[0].length),
D.first=!1,D.isFiltered=!0;if(0===s.length)break}if(!z)throw Error("puredom.getElement() :: Unknown CSS selector near: "+s.substring(0,20),"puredom.js",1775);}}if(!0!==m.includeInvisibles)for(w=o.length;w--;)o[w]&&"#"===(o[w].nodeName+"").charAt(0)&&o.splice(w,1);G&&b.log("query=",B,", result=",o);e&&!0===m.cache&&(d[y]=o);!0!==m.internal&&!0===G&&(A=Date.now()-A,10<A&&b.log('Slow Selector Warning: "'+B+'" took '+A+"ms to complete. "+E+" parse iterations."));return o};a.enableCache=function(b){(e=
!1!==b)||(d={})};a.disableCache=function(){e=!1;d={}};a.clearCache=function(){d={}};a._normalizeSelectorFilter=function(b){2===arguments.length&&(b={regex:arguments[0],filter:arguments[1]});return b&&b.regex&&b.filter?b:!1};a.addSelectorFilter=function(b){return(b=a._normalizeSelectorFilter.apply(a,arguments))?(j.push(b),!0):!1};a.removeSelectorFilter=function(b){var c,d,f;if(b=a._normalizeSelectorFilter.apply(a,arguments))for(c=j.length;c--;){f=!0;for(d in j[c])if(j[c].hasOwnProperty(d)&&j[c][d]!==
b[d]){f=!1;break}if(f){j.splice(c,1);break}}return!0===f};a.selectorStats=function(){return"disabled"};return a}();b.DOMEvent=function(){};window.wrappedEventListener=f.wrappedEventListener={list:[],none:{},summary:function(){for(var a=0;a<this.list.length;a++)b.log(f.idToNode(this.list[a].target),".on",this.list[a].type," -> ",this.list[a].handler.displayName||this.list[a].handler.name)},reset:function(a){var c;if(!0===a)for(a=this.list.length;a--;)c=this.list[a],this.list[a]=this.none,b.removeEvent(f.idToNode(c.target),
c.type,c.wrappedHandler),this.unsetRefs(c),window.killCount=(window.killCount||0)+1;this.list.splice(0,this.list.length)},destroyObjHandlers:function(a){var c,d,e=f.nodeToId(a);for(c=this.list.length;c--;)if(d=this.list[c],d.target===e)this.unsetRefs(d),this.list.splice(c,1),b.removeEvent(a,d.type,d.wrappedHandler),window.killCount=(window.killCount||0)+1},get:function(b,a,c,d){var e,g,c=f.nodeToId(c);for(e=this.list.length;e--;)if(g=this.list[e],g.target===c&&g.handler===a&&g.type===b){a=g.wrappedHandler;
if(!0===d)this.list.splice(e,1),window.killCount=(window.killCount||0)+1,this.unsetRefs(g);break}return a},unsetRefs:function(b){b.wrappedHandler.type=null;b.wrappedHandler.handler=null;b.wrappedHandler.target=null},internalFireEvent:function(b){var a=f.nodeToId(b.target),c=b.type.replace(/^on/gm,""),d,e;for(d=this.list.length;d--&&!(e=this.list[d],e.target===a&&e.type===c&&(e=e.handler.call(b.target,b),!1===e)););},create:function(a,c,d){d={type:a,target:f.nodeToId(d),handler:c,wrappedHandler:function(a){var c=
arguments.callee.handler,d=(arguments.callee.type||a.type).toLowerCase().replace(/^on/,""),e=this!==window?this:f&&f.idToNode(arguments.callee.target),i,g,k={isInSelf:!1,doPreventDefault:!1,doCancelBubble:!1,doStopPropagation:!1,e:a||window.event,ret:null,end:function(){var l;a=i=(l=c=d=e=k.end=null,k=l);return this.ret}};(!f||!f.idToNode)&&b.log("target:<"+a.target.nodeName+' class="'+a.target.className+'" id="'+a.target.id+'"> , type:'+d+"/"+a.type);a=k.e;i=b.extend(new b.DOMEvent,{which:a.which,
type:d,target:a.target||a.srcElement||e||document.body,relatedTarget:a.relatedTarget||("mouseout"===d?a.toElement:a.fromElement),preventDefault:function(){k.doPreventDefault=!0},stopPropagation:function(){k.doStopPropagation=!0;k.doCancelBubble=!0},cancel:function(){i.preventDefault();i.stopPropagation();return i.returnValue=!1},returnValue:!0,originalEvent:a,timeStamp:a.timeStamp||Date.now()});i.cancelBubble=i.stopPropagation;i.stop=i.prevent=i.cancel;for(g in a)!i.hasOwnProperty(g)&&"function"!==
typeof a[g]&&g!==g.toUpperCase()&&(i[g]=a[g]);i.target||b.log("Event target doesn't exist for type \""+i.type+'": ',i.target,", srcElement=",a.srcElement);if("touchend"===a.type&&f._lastTouchPos)i.pageX=f._lastTouchPos.pageX,i.pageY=f._lastTouchPos.pageY;else if(a.touches&&a.touches[0])i.pageX=a.touches[0].pageX,i.pageY=a.touches[0].pageY,f._lastTouchPos={pageX:i.pageX,pageY:i.pageY};else if(a.pageX||0===a.pageX||a.clientX||0===a.clientX)i.pageX=a.pageX||a.clientX+document.body.offsetLeft,i.pageY=
a.pageY||a.clientY+document.body.offsetTop;if(-1<d.indexOf("key")||a.keyCode||a.charCode)i.keyCode=a.keyCode||a.which,i.charCode=a.keyCode||a.charCode||a.which,i.which=a.which;if(-1<d.indexOf("mouse")||-1<d.indexOf("click")||null!==a.button&&void 0!==a.button)i.button=a.button||a.which;if(i.target&&3===i.target.nodeType&&3!==e.nodeType)i.target=i.target.parentNode;k.searchNode=i.relatedTarget||i.target;do if(k.searchNode===e){k.isInSelf=!0;break}while(k.searchNode&&(k.searchNode=k.searchNode.parentNode)&&
k.searchNode!==document);if("mouseover"!==d&&"mouseout"!==d||!k.isInSelf){if(c&&c.call)k.handlerResponse=c.call(e,i);i.returnValue=!1!==k.handlerResponse&&!1!==i.returnValue;if(k.doPreventDefault)i.returnValue=a.returnValue=!1,a.preventDefault&&a.preventDefault();if(k.doCancelBubble||k.doStopPropagation||!0===i.cancelBubble)if(a.stopPropagation&&a.stopPropagation(),a.cancelBubble){if(a.cancelBubble.call)try{a.cancelBubble()}catch(n){}}else try{a.cancelBubble=!0}catch(h){}k.ret=i.returnValue}else k.ret=
!0;return k.end()}};d.wrappedHandler.displayName="wrappedEventHandler_"+a;d.wrappedHandler.handler=c;d.wrappedHandler.type=a;d.wrappedHandler.target=d.target;this.list.push(d);d=a=c=d=null;return this.list[this.list.length-1].wrappedHandler}};f.getSubjectDescription=function(a){return(a.nodeName?b.el(a)+"":a.constructor&&a.constructor.name||a.name||a)+""};b.eventTypeMap={};f.support.webkitMultitouch&&b.extend(b.eventTypeMap,{mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"});b.addEvent=
function(a,c,d,e){var g;if(a){"string"===b.typeOf(c)&&-1<c.indexOf(",")&&(c=c.replace(/\s/gm,"").split(","));if(b.isArray(c)){for(e=0;e<c.length;e++)b.addEvent(a,c[e],d);return!0}g=c=(c+"").toLowerCase().replace(/^\s*(on)?(.*?)\s*$/gim,"$2");if("string"!==typeof c||!d||!d.call)b.log("Attempted to add event with invalid type or handler:",{type:c,handler:d+"",subject:f.getSubjectDescription(a),useCapture:!0===e});else if(b.eventTypeMap.hasOwnProperty(c)&&(c=b.eventTypeMap[c]),d=f.wrappedEventListener.create(g,
d,a),a.attachEvent)a.attachEvent("on"+c,d);else if(a.addEventListener)a.addEventListener(c,d,!0===e),window._eventCount=(window._eventCount||0)+1}};b.removeEvent=function(a,c,d,e){var g;if(a){"string"===b.typeOf(c)&&-1<c.indexOf(",")&&(c=c.replace(/\s/gm,"").split(","));if(b.isArray(c)){for(g=0;g<c.length;g++)b.removeEvent(a,c[g],d,e);return!0}g=c=(c+"").toLowerCase().replace(/^\s*(on)?(.*?)\s*$/gim,"$2");if("string"!==typeof c||!d||!d.call)b.log("Attempted to remove event with invalid type or handler:",
{type:c,handler:d+"",subject:f.getSubjectDescription(a),useCapture:!0===e});else if(b.eventTypeMap.hasOwnProperty(c)&&(c=b.eventTypeMap[c]),d=f.wrappedEventListener.get(g,d,a,!0),a.detachEvent)a.detachEvent("on"+c,d);else if(a.removeEventListener)try{a.removeEventListener(c,d,!0===e),window._eventCount=(window._eventCount||0)-1}catch(h){}}};b.cancelEvent=function(b){if(b=b||window.event){b.preventDefault&&b.preventDefault();b.stopPropagation&&b.stopPropagation();try{b.cancelBubble=!0}catch(a){}b.returnValue=
!1}return!1};b.fireEvent=function(a){var c,d,e,g,h,a=a||{};if(document.createEventObject){a=b.extend({},a);a.type="on"+a.type.toLowerCase().replace(/^on/,"");try{c=document.createEventObject()}catch(j){h=!0}if(!h){for(e in a)if(a.hasOwnProperty(e))try{c[e]=a[e]}catch(m){}try{d=a.target.fireEvent(a.type,c),g=!0===c.preventDefault}catch(I){h=!0}}h&&f.wrappedEventListener.internalFireEvent&&f.wrappedEventListener.internalFireEvent(a)}else{c=document.createEvent("HTMLEvents");c.initEvent(a.type.toLowerCase().replace(/^on/,
""),!0,!0);for(e in a)if(a.hasOwnProperty(e))try{c[e]=a[e]}catch(q){}d=!a.target.dispatchEvent(c);g=!0===c.preventDefault}return{evt:c,preventDefault:g,rval:d}};f._nodeToIdIndex=0;f._nodeToIdList={};window._nodeToIdList=f._nodeToIdList;f.nodeToId=function(a){var c;if(a===window)return"_td_autoid_window";if(a===document)return"_td_autoid_document";if(a===document.body)return"_td_autoid_documentbody";(c=/\s_td_autoid_([0-9]+)\s/gm.exec(" "+a.className+" "))&&c[1]?c=c[1]:(f._nodeToIdIndex+=1,c=f._nodeToIdIndex+
"",b.addClass(a,"_td_autoid_"+c));f.ensureNodeIdListing(a,c);return c};f.idToNode=function(a){var c;c=f._nodeToIdList[a+""];var d;if("_td_autoid_window"===a)return window;if("_td_autoid_document"===a)return document;if("_td_autoid_documentbody"===a)return document.body;c&&(d=b.getElement(c),/\s_td_autoid_[0-9]+\s/gm.exec(" "+d.className+" ")||(d=null));d||(d=(c=b.getElement("._td_autoid_"+a))&&c[0])&&f.ensureNodeIdListing(d,a);return d||!1};f.ensureNodeIdListing=function(b,a){var c;b.getAttribute&&
(c=b.getAttribute("id"),c||(c="_td_autoid_"+a,b.setAttribute("id",c)),f._nodeToIdList[a]="#"+c)};f.removeNodeUID=function(b){var a=b.getAttribute("id");a&&a.match(/^_td_autoid_[0-9]+$/g)&&(b.removeAttribute?b.removeAttribute("id"):b.setAttribute("id",""));if(b.className)b.className=b.className.replace(/(^|\b)_td_autoid_[0-9]+(\b|$)/gim,"")};b.animationFrame=function(b){var a={manualFramerate:11};window.mozRequestAnimationFrame?b="moz":window.webkitRequestAnimationFrame&&(b="webkit");a.nativeSupport=
!!b;a.nativeSupport?(a.getTimer=function(a){return window[b+"RequestAnimationFrame"](a)},a.cancelTimer=function(a){window[b+"CancelRequestAnimationFrame"](a)},a.getStartTime=function(){return window[b+"AnimationStartTime"]||(new Date).getTime()}):(a.getTimer=function(b){return setTimeout(function(){b((new Date).getTime());b=null},a.manualFramerate)},a.cancelTimer=function(b){clearTimeout(b)},a.getStartTime=function(){return(new Date).getTime()});return a}();b.setOpacity=function(b,a){1>=a&&0<a&&(a*=
100);a=Math.round(a);100>a?(b.style.opacity=parseFloat(a/100).toFixed(2),b.style.filter="alpha(opacity="+a+")"):(b.style.opacity=null,b.style.filter=null)};b.applyMsFilter=function(a,c,d){var e,g="",h="MsFilter"===f.support.filterProperty?'"':"",j,m,I,c=c.charAt(0).toUpperCase()+c.substring(1);if("string"===typeof d){g=d;d={};m=g.replace(/\s*(,|=)\s*      /gm,"$1").split(",");for(j=0;j<m.length;j++)I=m[j].indexOf("="),d[m[j].substring(0,I)]=m[j].substring(I+1)}else{for(j in d)d.hasOwnProperty(j)&&
(g+=", "+j+"="+d[j]);g=g.replace(",","")}try{e=a.filters&&a.filters.item&&(a.filters.item("DXImageTransform.Microsoft."+c)||a.filters.item(c))}catch(q){}if(e){for(j in d)d.hasOwnProperty(j)&&"enabled"!==j&&(e[j]=d[j]);e.enabled=d.enabled?1:0}else d=a.style.MsFilter||a.style.filter||"",(d+=" "+(b.nodeStyle(a,"MsFilter")||b.nodeStyle(a,"filter")||""))&&(d=d.replace(RegExp('(^|s|))"?((progid:)?DXImageTransform.Microsoft.)?'+c+'s*?(.*?)"?s*?',"gim"),"$1")+" "),a.style[f.support.filterProperty]=d+h+"progid:DXImageTransform.Microsoft."+
c+"("+g+")"+h;if(!a.style.zoom)a.style.zoom=1};b.applyCss=function(a,c){var g,h,j,m,u,c=c||{};for(g in c)if(c.hasOwnProperty(g))try{if(h=b.getStyleAsCSS(g),h=h.replace(/^\-(moz|webkit|ms|o|vendor)\-/gim,d+"-"),h=b.getStyleAsProperty(h),"opacity"===h&&f.support.filters)u=Math.round(100*parseFloat(c[g])),100>u?b.applyMsFilter(a,"alpha",{enabled:!0,opacity:u}):b.applyMsFilter(a,"alpha",{enabled:!1});else if("--box-shadow"===h&&f.support.filters)j=(j=c[g].match(/\b(\#[0-9af]{3}[0-9af]{3}?|rgba?\([0-9\,\s]+\))\b/gim))&&
j[0]||"",m=(" "+c[g]+" ").replace(j,"").replace(/\s+/m," ").split(" ").slice(1,4),b.applyMsFilter(a,"glow",{Color:j,Strength:Math.round(m[3].replace(/[^0-9\-\.]/gim,""))});else if(a.style[h]=c[g],"boxShadow"===h||"textShadow"===h||"borderRadius"===h)e&&(a.style[e+h]=c[g])}catch(y){}};b.getStyleAsProperty=function(a){return"string"===b.typeOf(a)&&a.replace(/\-[a-z0-9]/gim,function(a){return a.charAt(1).toUpperCase()})||null};b.getStyleAsCSS=function(a){return"string"===b.typeOf(a)&&a.replace(/\-*[A-Z]/gm,
"-$0").toLowerCase()||null};b.getCssTransitions=function(a){var c={},d={properties:"-vendor-transition-property",durations:"-vendor-transition-duration",timingFunctions:"-vendor-transition-timing-function"},f,e;for(f in d)d.hasOwnProperty(f)&&(d[f]=(b.nodeStyle(a,d[f])||"").replace(/\s/,"").split(","));for(a=0;a<d.properties.length;a++)d.properties[a]&&"null"!==d.properties[a]&&!("all"===d.properties[a]&&d.durations[a].match(/^[0\.ms]*$/))&&(f=d.durations[a]||d.durations[d.durations.length-1],e=parseFloat(f.replace(/[^\-0-9\.]/gim,
""))||0,f.match(/ms$/i)||(e*=1E3),c[b.getStyleAsProperty(d.properties[a])]={duration:e,timingFunction:d.timingFunctions[a]||d.timingFunctions[d.timingFunctions.length-1]||"ease"});return c};b.setCssTransitions=function(a,c){var d={"-vendor-transition-property":[],"-vendor-transition-duration":[],"-vendor-transition-timing-function":[]},f;for(f in c)c.hasOwnProperty(f)&&c[f]&&(d["-vendor-transition-property"].push(f.toLowerCase()),d["-vendor-transition-duration"].push((c[f].duration/1E3).toFixed(3)+
"s"),d["-vendor-transition-timing-function"].push(c[f].timingFunction||"ease"));for(f in d)d.hasOwnProperty(f)&&(d[f]=d[f].join(", "));b.applyCss(a,d)};b.updateCssTransitions=function(a,c){var d,f;if(c){d=b.getCssTransitions(a);for(f in c)c.hasOwnProperty(f)&&(c[f]?d[f]=c[f]:delete d[f]);b.setCssTransitions(a,d)}};b.addClass=function(a,c){var d,f;if(c){b.isArray(c)||(c=[c]);d=a.className||"";if(0<d.length){d=" "+d+" ";for(f=0;f<c.length;f++)for(;-1<d.indexOf(" "+c[f]+" ");)d=d.replace(" "+c[f]+" ",
" ");d=d.substring(1)}a.className=(d+c.join(" ")).replace(/\s+/gim," ")}};b.removeClass=function(a,c){var d,f;if(c){b.isArray(c)||(c=[c]);d=a.className||"";if(0<d.length){d=" "+d+" ";for(f=0;f<c.length;f++)for(;-1<d.indexOf(" "+c[f]+" ");)d=d.replace(" "+c[f]+" "," ");d=d.substring(1)}a.className=d.replace(/\s+/gim," ")}};b.nodeStyle=function(a,b){var c=(b+"").replace(/[A-Z]/g,"-$0").toLowerCase(),e,g,c=c.replace(/^\-(moz|webkit|ms|o|vendor)\-/gim,d+"-");e=c.replace(/\-[a-z]/gim,function(a){return a.substring(1).toUpperCase()});
if("opacity"===c&&f.support.filters)return a.filters.alpha&&!1!==a.filters.alpha.enabled&&Math.round(a.filters.alpha.opacity)/100;a.style&&a.style[e]?g=a.style[e]||"":a.currentStyle&&a.currentStyle[e]?g=a.currentStyle[e]||a.currentStyle[c]||"":document.defaultView&&document.defaultView.getComputedStyle?g=(g=document.defaultView.getComputedStyle(a,null))&&(g.getPropertyValue(c)||g.getPropertyValue(e))||"":window.getComputedStyle&&(g=(g=window.getComputedStyle(a,null))&&(g.getPropertyValue(c)||g.getPropertyValue(e))||
"");return g};b.htmlEntities=function(a,c){var d=["htmlEntities"];!0===c&&d.push("stripTags");return b.text.filter(a,d)};b.log=function(){var a,b,c;if(window.console&&window.console.log)try{window.console.log.apply(window.console,arguments)}catch(d){c=[];a="args[0]";for(b=1;b<arguments.length;b++)c.push(arguments[b]),a+=",args["+b+"]";eval("window.console.log("+a+")")}};b.addNodeSelectionPlugin=function(a,c){b.NodeSelection.prototype.hasOwnProperty(a)||(b.NodeSelection.prototype[a]=function(){var a=
c.apply(this,arguments);if(null===a||void 0===a)return this})};b.init=function(){c||(c=!0,b.forEach(f.oninit,function(a){a.call(b,b)}),b.fireEvent({target:document.body,type:"puredomready",puredom:b}))};b.addEvent(document,"DOMContentLoaded",b.init);b.addEvent(window,"load",b.init);b.addEvent(window,"unload",f.unload);(function(){if(window._previousPureDom){for(var a in window._previousPureDom)window._previousPureDom.hasOwnProperty(a)&&(b[a]=window._previousPureDom[a]);window._previousPureDom=null;
try{delete window._previousPureDom}catch(c){}}})();f.puredom=function(a){return"function"===b.typeOf(a)?(!0===c?a.call(b,b):f.oninit.push(a),b):b.el.apply(b,arguments)};b.extend(b,a);b.toString=function(){return"function puredom(){}"};window.puredom=b})();window.puredom=window.puredom||{};
(function(){var b={text:function(){var a=function(){return a.filter.apply(this,arguments)},b=/[&<>"]/gim,e=/(^|\s)[a-z]/gim,g=/^[a-z]/gim,h=/\r?\n/g,j=/[^0-9.\-]/gim;a.filter=function(b,d){var e,g,h,j,l;"array"!==puredom.typeOf(d)&&(d=((d||"")+"").split("|"));if(2<arguments.length)for(e=2;e<arguments.length;e++)"array"===puredom.typeOf(arguments[e])?d=d.concat(arguments[e]):d.push(arguments[e]);for(e=0;e<d.length;e++)for(l in g=d[e],j=[b],h=g.indexOf(":"),-1<h&&(g=g.substring(0,h),j=j.concat(d[e].substring(h+
1).split(","))),a)if((l+"").toLowerCase()===g.toLowerCase()){b=a[l].apply(a,j);break}return b};a.escape=function(a){return encodeURIComponent(a)};a.unescape=function(a){return decodeURIComponent(a)};a.htmlEntities=function(a){var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};return(a+"").replace(b,function(a){return c[a]})};a.ucWords=function(a){return(a+"").toLowerCase().replace(e,function(a){return a.toUpperCase()})};a.ucFirst=function(a){return(a+"").toLowerCase().replace(g,function(a){return a.toUpperCase()})};
a.nl2br=function(a){return(a+"").replace(h,"<br />")};a.numbersOnly=function(a){return(a+"").replace(j,"")};a.truncate=function(a,b,c,d){var e=!1,g=a+"",a=g,b=parseInt(b,10)||80,d=d||"...";a.length>b&&(!0===c||"true"===c||"byWord"===c?(a=a.substring(0,b),g.charAt(b).match(/\s/)||(a=a.replace(/\s[^\s]*$/,""))):a=a.substring(0,b-d.length),e=!0);e&&(a+=d);return a};a.trim=function(a){var b,c,a=a.replace(/^\s\s*/,"");b=/\s/;for(c=a.length;b.test(a.charAt(--c)););return a.slice(0,c+1)};a["default"]=function(b,
d){return(b=a.trim(b))?b:d};a.dateformat=function(a,b){var c=puredom.i18n,d=puredom.date;d&&d.create&&(date=d.create(a));if(!date||-1<(date+"").indexOf("Invalid"))if(date=new Date(a),!date||-1<(date+"").indexOf("Invalid"))date=new Date,date.setTime(Math.round(a));b&&-1<b.indexOf("%")?d&&d.format&&(a=d.format(date,b)):c&&(a=c(date,null,null,{datetype:b||"date"})||date+"");return a};return a}(),parameterize:function(a,b){var e=[],g,h,j,f=puredom.extend({delimiter:"&",startDelimiter:"?",assignment:"=",
typeHandlers:null},b);for(g in a)if(a.hasOwnProperty(g))if(h=a[g],j=this.typeOf(h),f.typeHandlers&&f.typeHandlers.hasOwnProperty(j))e.push(f.delimiter+encodeURIComponent(g)+"="+encodeURIComponent(f.typeHandlers[j](h)));else if("array"===j&&!0!==f.disableArrayParams)for(j=0;j<h.length;j++)e.push(f.delimiter+encodeURIComponent(g)+"[]="+encodeURIComponent(h[j]));else{switch(j){case "boolean":h=h?"true":"false";break;case "null":case "undefined":h="";break;case "object":h=!1!==f.useJsonForObjects?this.json(h):
this.parameterize(h)}e.push(encodeURIComponent(g)+"="+encodeURIComponent(h))}e=e.join(f.delimiter||"&");return e=(f.startDelimiter||"")+e},querystring:{parse:function(a){var b,e,g={};"?"===a.substring(0,1)&&(a=a.substring(1));a=a.split("&");for(b=0;b<a.length;b++)a[b]&&(e=a[b].indexOf("="),g[decodeURIComponent(a[b].substring(0,e))]=0>e?"":decodeURIComponent(a[b].substring(e+1)));return g},stringify:function(a,b){b=puredom.extend({startDelimiter:""},b||{});return puredom.parameterize(a,b)},build:function(){return puredom.querystring.stringify.apply(puredom.querystring,
arguments)}},cookies:function(){var a={};return{set:function(b,e,g,h,j,f){var m="",v="",i,j="string"===typeof j?j:"";g&&(i=new Date,i.setTime(i.getTime()+864E5*g),m="; expires="+i.toGMTString());a.hasOwnProperty(b)&&a[b].expires&&(m="; expires="+a[b].expires.toGMTString());v=b+"="+encodeURIComponent(e)+m+"; path=/"+j.replace(/^\//,"");"string"===typeof h&&0<h.length&&(v+="; domain="+h.replace(/[\;\,]/,""));!0===f&&(v+="; secure");document.cookie=v;a[b]={value:e,expires:i}},get:function(b,e){if(a.hasOwnProperty(b)&&
!0!==e)return a[b].value;var g,h,j=document.cookie.split(";");for(h=0;h<j.length;h++)if(g=j[h].replace(/^\s+/gim,""),0===g.indexOf(b+"="))return decodeURIComponent(g.substring(b.length+1,g.length));return null},remove:function(b){this.set(b,"",-1);delete a[b]},purge:function(){for(var b in a)a.hasOwnProperty(b)&&(this.remove(b),delete a[b])},read:function(){return this.get.apply(this,arguments)},write:function(){return this.set.apply(this,arguments)}}}(),Cache:function(){function a(){if(this.constructor!==
arguments.callee&&this.constructor!==a)return new a;this.data={}}puredom.extend(a.prototype,{defaultType:"_default",purge:function(){this.data={}},get:function(a,b,c){var h;2===arguments.length&&(c=b=a,a=null);a=(a||this.defaultType)+"";b+="";h=this.data.hasOwnProperty(a)&&this.data[a][b]||!1;return c?(h&&c(h),!!h):h},set:function(a,b,c){2===arguments.length&&(c=b=a,a=null);a=(a||this.defaultType)+"";this.data[a]||(this.data[a]={});this.data[a][b+""]=c},proxySet:function(a,b,c,h){var j=this;return function(){j.set(a,
b,arguments[h||0]);c&&c.apply(c,arguments)}},each:function(a){return puredom.foreach(this.data,a)}});return a}(),json:function(){var a=function(b){return"string"===puredom.typeOf(b)?a.parse(b):a.stringify(b)};a.stringify=function(a){var b;try{b=JSON.stringify(a)}catch(c){puredom.log("puredom.json:: Stringify failed: "+c+" | "+a)}return b};a.parse=function(a){var b;if("string"===typeof a&&0<a.length)try{b=JSON.parse(a)}catch(c){puredom.log("puredom.json:: Parse failed: "+c+" | "+a)}return b};a.serialize=
a.stringify;a.unserialize=a.parse;return a}(),xml:{parse:function(a){var b;window.DOMParser?b=(new window.DOMParser).parseFromString(a,"text/xml"):(b=new window.ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a));return b}}},a;for(a in b)b.hasOwnProperty(a)&&(puredom[a]=b[a]);b=null})();window.puredom=window.puredom||{};puredom.EventEmitter=function(){this._eventRegistry=[]};
puredom.EventEmitter.prototype.addEventListener=function(b,a){var c,d,b=(b+"").toLowerCase().replace(/\s+/gim,"");if(-1<b.indexOf(",")){c=b.split(",");for(d=0;d<c.length;d++)this.addEventListener(c[d],a);return this}b=b.replace(/^on/,"");this._eventRegistry.push({type:b,handler:a});return this};puredom.EventEmitter.prototype.addListener=puredom.EventEmitter.prototype.addEventListener;puredom.EventEmitter.prototype.on=puredom.EventEmitter.prototype.addEventListener;
puredom.EventEmitter.prototype.removeEventListener=function(b,a){var c,d,b=(b+"").toLowerCase().replace(/\s+/gim,"");if(-1<b.indexOf(",")){c=b.split(",");for(d=0;d<c.length;d++)this.removeEventListener(c[d],a);return this}b=b.replace(/^on/,"");for(c=this._eventRegistry.length;c--;)if(d=this._eventRegistry[c],d.type===b&&d.handler===a){this._eventRegistry.splice(c,1);break}return this};puredom.EventEmitter.prototype.removeListener=puredom.EventEmitter.prototype.removeEventListener;
puredom.EventEmitter.prototype._fireEvent=function(b,a){var c,d,e=[],b=(b+"").toLowerCase().replace(/^on/,"");puredom.isArray(a)||(a=[a]);for(c=this._eventRegistry.length;c--;)if(d=this._eventRegistry[c],d.type===b){if(0===e.length)e.falsy=e.falsey=e.truthy=!0;d=d.handler.apply(this,a);e.push(d);if(!0===d)e.falsy=e.falsey=!1;else if(!1===d)e.truthy=!1;if(!1===d)break}return e};
puredom.ControllerManager=function(b){puredom.EventEmitter.call(this);this.controllerOptions=puredom.extend({},this.controllerOptions);this._messageListeners=[];this._controllers=[];this._current=null;if(b){b.controllerOptions&&puredom.extend(this.controllerOptions,b.controllerOptions);if("boolean"===puredom.typeOf(b.singular))this.singular=b.singular;if("boolean"===puredom.typeOf(b.allowLoadDefault))this.allowLoadDefault=b.allowLoadDefault}};
puredom.extend(puredom.ControllerManager.prototype,{controllerOptions:{},restoreState:function(b){!0!==this.initialized?this._initState=b:b&&b.current?this.load(b.current):this.loadDefault()},doStateUpdate:function(b,a){this.updateState&&this.updateState(b,a)},init:function(b){var a=!0;if(!0!==this.initialized){this.initialized=!0;if(b){b.controllerOptions&&puredom.extend(this.controllerOptions,b.controllerOptions);if("boolean"===puredom.typeOf(b.singular))this.singular=b.singular;if("boolean"===
puredom.typeOf(b.allowLoadDefault))this.allowLoadDefault=b.allowLoadDefault;!1===b.autoRestoreOnInit&&(a=!1)}this._initState&&a&&this.restoreState(this._initState);this._initState=null;try{delete this._initState}catch(c){}!1!==this.allowLoadDefault&&!this.current()&&this.loadDefault()}},destroy:function(){var b,a;try{(b=this.current())&&b.unload&&b.unload();for(a=this._controllers.length;a--;)this._controllers[a].destroy&&this._controllers[a].destroy()}catch(c){}this.controllerOptions={};this._controllers=
[];this._messageListeners=[];this._current=null},register:function(b,a){a=a||{};"string"===puredom.typeOf(b)?a.name=b:a=b;this._controllers.push(a);this._fireEvent("add",[this.getIdFromName(a.name)])},load:function(b,a){var c,d,e,g,b=(b+"").toLowerCase();if((d=!0===this.singular&&this.current())&&d.name.toLowerCase()===b)return d.handleRepeatLoad&&d.handleRepeatLoad(a||{}),!0;c=this._createControllerSandbox(b);d=puredom.extend({previousController:d},this.controllerOptions||{},a||{},c.sandbox);if(e=
b&&this.get(b)){puredom.extend(e,c.sandbox);if(!0===this.singular&&(c=this._unloadCurrent(),!1===c))return!1;c=e;if(e.load){g=this._fireEvent("beforeload",[e.name]);if(!1===g||g.falsey&&!g.truthy)return!1;g=e.load(d);null!==g&&void 0!==g&&(c=g)}if(!1===g){g=this._fireEvent("loadcancel",[e.name]);if(!1===g||g.falsey&&!g.truthy)return!1;!0===this.singular&&d.previousController?this.load(d.previousController.name,a):this.loadDefault(a)}else this._current=this.getIdFromName(b),this._fireEvent("load",
[b]),this._fireEvent("change",[b]),this.doStateUpdate({current:b});return c}return!1},loadDefault:function(b){for(var a=this._controllers.length;a--;)if(!0===this._controllers[a].isDefault)return this.load(this._controllers[a].name,b);return!1},loadPrevious:function(b){this._previousController&&this.load(this._previousController,b)},none:function(){this._unloadCurrent()},reloadCurrent:function(){var b=this.current();b&&(this._unloadCurrent(),this.load(b.name,this.controllerOptions))},_unloadCurrent:function(){var b=
this.current(),a;if(b&&b.unload){a=this._fireEvent("beforeunload",[b.name]);if(!1===a||a.falsey&&!a.truthy)return!1;a=b.unload();if(!1===a)return!1;this._fireEvent("unload",[b.name]);this._current=null}},get:function(b,a){for(var b=(b+"").toLowerCase(),c=this._controllers.length;c--;)if(this._controllers[c].name.toLowerCase()===b)return!0===a?c:this._controllers[c];return!1},postMessage:function(b,a){var c=this.current();return c&&c.onmessage?(c.onmessage(b,a),!0):!1},onMessage:function(b,a,c){b=
{type:(b+"").toLowerCase().replace(/^on/gim,""),handler:a};if(c)if("string"===puredom.typeOf(c))b.controller=c.toLowerCase();else if(c.hasOwnProperty("name"))b.controller=(c.name+"").toLowerCase();this._messageListeners.push(b)},getList:function(b){var a=[],c,d,e,b=b||[];for(c=0;c<this._controllers.length;c++){e={name:this._controllers[c].name};for(d=0;d<b.length;d++)e[b[d]]=this._controllers[c][b[d]];a.push(e)}return a},getIdFromName:function(b){return this.get(b,!0)},getNameFromId:function(b){return(b=
"number"===puredom.typeOf(b)&&this._controllers[b])&&b.name||!1},current:function(){return"number"===puredom.typeOf(this._current)&&this._controllers[this._current]||!1},_createControllerSandbox:function(b){var a=this,c,d,e=!1,b=(b+"").toLowerCase();c={controllerManager:a,manager:a,postMessage:function(c,d){var j,f,d=puredom.extend({},d,{controller:b,type:(c+"").replace(/^on/gim,"")});if(!e){a._fireEvent("message",d);a._fireEvent(d.type,d);for(f=0;f<a._messageListeners.length;f++)if(j=a._messageListeners[f],
!j.controller||j.controller===b.toLowerCase())try{j.handler(d)}catch(m){throwListnerError(j,m)}}}};d={setName:function(a){b=(a+"").toLowerCase()},mute:function(){e=!0},unmute:function(){e=!1},destroy:function(){for(var b in this.sandbox)this.sandbox.hasOwnProperty(b)&&(this.sandbox[b]=null);delete this.sandbox;a=null},sandbox:c};setTimeout(function(){d=c=null},1);return d},_postMessageFromController:function(){},_controllers:[],_messageListeners:[],_current:null});
puredom.inherits(puredom.ControllerManager,puredom.EventEmitter);puredom.ViewManager=function(b){puredom.EventEmitter.call(this);this._htmlViews={};this._postProcessors=[];b&&!0===b.init&&this.init(b)};
puredom.extend(puredom.ViewManager.prototype,{viewDomPrefix:"views_",_regs:{node:/<(\/?)([a-z][a-z0-9]*)(\s+[a-z0-9._-]+=(['"]).*?\4)*\s*\/?>/gim},init:function(b){b=b||{};if(!0!==this.initialized){this.initialized=!0;if(b.viewDomPrefix)this.viewDomPrefix=b.viewDomPrefix;this.cacheBase=puredom.el({className:"views_cacheBase",css:"display: none;"},b.cacheBase||document.body)}},destroy:function(){if(!0===this.initialized)this.initialized=!1},log:function(b,a){!0===this.logging&&puredom.log("ViewManager :: "+
b,a)},addView:function(b,a){"string"===puredom.typeOf(a)?this._htmlViews[(b+"").toLowerCase()]=a:this.load(b,!1)},exists:function(b){return this._htmlViews.hasOwnProperty((b+"").toLowerCase())},template:function(b,a,c,d){var e,b=(b+"").toLowerCase(),a=a||{};this._htmlViews.hasOwnProperty(b)&&(b=this._htmlViews[b],e=this.load(puredom.template(b,a),c,d,null,!1));return e||!1},load:function(b,a,c,d,e){var g,h;if(b)if(h=!1!==e&&this.getCachedView(b))this.log('Using cached view for "'+b+'".'),g=this.buildCachedView(h);
else if("string"===puredom.typeOf(b))this._regs.node.lastIndex=0,this._regs.node.test(b)?(this.log('Parsing HTML view for "'+b+'".'),g=this.buildViewFromHTML(b),b=null):this._htmlViews.hasOwnProperty((b+"").toLowerCase())?(this.log('Loading stored HTML view for "'+b+'".'),g=this.buildViewFromHTML(this._htmlViews[(b+"").toLowerCase()])):(this.log('Looking up in-DOM view for "'+b+'"...'),(h=this.getViewFromDOM(b))&&h.exists()?(this.log("Lookup succeeded, view found."),g=this.buildViewFromDOM(h,!1!==
d)):this.log("Lookup failed, no matching view found."));if(g&&g.exists())return b&&(this.log('View "'+b+'" loaded.'),!1!==e&&this.cacheView(b,g,!1!==d),g.classify("views_"+b)),g.parent().exists()||(c&&c.parent().insertBefore(g,c),!c&&a&&g.insertInto(a)),this.postProcessView(g),g;puredom.log('ViewManager :: Unable to find view "'+b+'".');return!1},unload:function(b){b&&b.destroy&&b.destroy()},_postProcessors:[],addViewPostProcessor:function(b){var a,c=!1;for(a=this._postProcessors.length;a--;)if(this._postProcessors[a]===
b){c=!0;break}c||this._postProcessors.push(b)},postProcessView:function(b){for(var a=0;a<this._postProcessors.length;a++)this._postProcessors[a](b)},getViewFromDOM:function(b,a){var c,a=a||this.viewDomPrefix;a.match(/[a-z0-9_-]/i)&&(a="#"+a);b=b.replace(/[\s.\/\\]/gim,"");this.log('Lookup: prefix="'+a+'", def="'+b+'"');return a&&(c=puredom.el(a+b))&&c.exists()?c:!1},buildViewFromHTML:function(b){b=puredom.el({innerHTML:b});b=b.children();b.remove();return b.exists()&&b||!1},buildViewFromObj:function(b){puredom.isArray(b)?
(b=tinyom.el({children:b}),b=b.children()):(b=puredom.extend({},b,{parent:null,insertBefore:null}),b=puredom.el(b));return b.exists()&&b||!1},buildViewFromDOM:function(b,a){var c,b=puredom.el(b);if(!1===a)return b;c=b.clone(!0);return c.exists()&&c||!1},_htmlViews:{},cacheBase:null,getCachedView:function(b){b=this.cacheBase.query('[data-viewname="'+b+'"]').first();return b.exists()&&b||!1},buildCachedView:function(b){"string"===puredom.typeOf(b)&&(b=this.getCachedView(b));(b=b&&this.buildViewFromDOM(b))&&
b.attr("id",this.viewDomPrefix+b.attr("data-viewname"));return b},cacheView:function(){return!1}});puredom.inherits(puredom.ViewManager,puredom.EventEmitter);puredom.TestSuite=function(){puredom.EventEmitter.call(this);this.list={}};
puredom.extend(puredom.TestSuite.prototype,{add:function(b,a){this.list[this._getIdFromName(b)]={name:b,test:a,results:[]}},run:function(b,a,c){var d=this.get(b),e=d&&d.test,g=null,h,j,f,m,v;if(e&&e.run)j=function(a,b){"status"===a&&(v=b);if("result"===a)g=!0===b;else if(c)return c(a,b),!1},h=function(b){e.cleanup&&e.cleanup(m);if(b)v=b;else if(m.results)v=m.results;b&&d.results.push({time:(new Date).getTime(),results:b});a&&a(v,g);f.destroy();h=j=v=d=e=f=m=a=c=null},f=this._createSandboxController(d),
f.messageHandler=j,f.onfinish=h,m=f.getSandbox(),e.prepare&&e.prepare(m),results=e.run(m)},get:function(b){b=this._getIdFromName(b);return this.list.hasOwnProperty(b)&&this.list[b]||!1},getList:function(){var b=[],a;for(a in this.list)this.list.hasOwnProperty(a)&&this.list[a].name&&b.push(this.list[a].name);return b},_getIdFromName:function(b){return(b+"").toLowerCase().replace(/[^a-z0-9_]+/gm,"")},_createSandboxController:function(b){var a=this,c={},d={};c.getSandbox=function(){return d};c.destroy=
function(){d=c=a=b=null};d.status=d.setStatus=function(d){var g;c.messageHandler&&(g=c.messageHandler.call(a,"status",d));!1!==g&&puredom.log('tests["'+b.name+'"] >> '+d)};d.log=d.postMessage=function(d){var g;c.messageHandler&&(g=c.messageHandler.call(a,"log",d));!1!==g&&puredom.log('tests["'+b.name+'"] >> '+d)};d.done=d.finish=d.complete=function(b){c.onfinish&&setTimeout(function(){c.messageHandler&&c.messageHandler.call(a,"status",b);c.onfinish&&c.onfinish.call(a,b);b=null},1)};d.pass=function(b){c.messageHandler&&
c.messageHandler.call(a,"result",!0);c.onpass&&c.onpass.call(a,!0);d.done(b)};d.fail=function(b){c.messageHandler&&c.messageHandler.call(a,"result",!1);c.onfail&&c.onfail.call(a,fail);d.done(b)};return c},list:{}});
puredom.StateManager=function(b,a){var c;!a&&"object"===puredom.typeOf(b)&&(a=b,b=a.adapter||a.adaptor);a=a||{};if(a.adaptor)a.adapter=a.adaptor,a.adapter=null;b=b||a.adapter;this.initialized=!1;this.objects={};this.states={};if(!b||!this.adapters[b])b=this.defaultAdapter;this.adapter=puredom.extend({},this.adapters.none,this.adapters[b],{stateManager:this});this.adapter.init&&this.adapter.init(puredom.extend({},a.adapterOptions||a.adaptorOptions||{},{adapter:b}),this);a.state&&(this.adapter.setState(a.state),
this.restoreFromState(a.state));if(a.objects)for(c in a.objects)this.addObject(c,a.objects[c])};
puredom.extend(puredom.StateManager.prototype,{saveQueueDelay:50,replaceTimeout:0,adapters:{session:{getState:function(b){b(this.state)},setState:function(b,a){this.state=b;a(!0)},state:{}},base:{getState:function(){throw Error("StateManager:: getState method not defined for the specified adapter.");},setState:function(){throw Error("StateManager:: setState method not defined for the specified adapter.");}}},objects:{},states:{},initialized:!1,init:function(b){if(!0===this.initialized)return this;
b=b||{};b.state&&(this.adapter.setState(b.state),this.restoreFromState(b.state));if(b.objects)for(x in b.objects)this.addObject(x,b.objects[x]);this.initialized=!0;!1!==b.restore&&this.restore();this.startPolling();return this},destroy:function(){this.stopPolling();this.adapter=this.states=this.objects=this.adapter.stateManager=null;this.initialized=!1},emptyFunc:function(){},startPolling:function(){this.adapter&&this.adapter.startPolling&&this.adapter.startPolling()},stopPolling:function(){this.adapter&&
this.adapter.stopPolling&&this.adapter.stopPolling()},addObject:function(b,a){var c;if(this.objects.hasOwnProperty(b))throw Error("Cannot add duplicate object ID '"+b+"' to state list.");c=this;this.objects[b]=a;this.states[b]={};a.updateState=function(a,e,g){c.setObjState(b,puredom.extend({},c.getObjState(b),a),e||c.emptyFunc,g)};a.setState=function(a,e,g){c.setObjState(b,a,e||c.emptyFunc,g)};a.getState=function(){return c.getObjState(b)};a.destroyStateManagerConnections=function(){this.updateState=
this.setState=this.getState=this.destroyStateManagerConnections=c.emptyFunc;c=null};a=null;!0===this.initialized&&this.restoreOne(b,function(){});return this},addObj:function(){return this.addObject.apply(this,arguments)},removeObject:function(b,a){if(this.objects.hasOwnProperty(b)){this.objects[b].destroyStateManagerConnections&&this.objects[b].destroyStateManagerConnections();this.objects[b]=null;this.states[b]=null;try{delete this.objects[b],delete this.states[b]}catch(c){}this.save(a)}},removeObj:function(){return this.removeObject.apply(this,
arguments)},restoreFromState:function(b,a,c){var d=this,e,g,h=0,j=0;e=a?function(){j+=1;j>=h&&(!1!==c?d.save(function(){a&&a(!0);d=a=null}):(a&&a(!0),d=a=null))}:function(){};"string"===puredom.typeOf(b)&&(b=puredom.json(b));for(g in this.objects)this.objects[g].restoreState&&(h+=1,this.objects[g].restoreState(b[g]),e());0===h&&(a&&a(!1),d=a=null);return this},disableSave:function(){this._saveDisabled=!0},enableSave:function(){this._saveDisabled=!1},restoreOne:function(b,a){var c=this;this.adapter.getState(function(d){c.objects[b]&&
c.objects[b].restoreState&&c.objects[b].restoreState(d[b]);c=null;a&&a()})},restore:function(b){var a=this;this._restoring=!0;this.adapter.getState(function(c){var d=c&&puredom.json(c);a._lastSaveTime=(new Date).getTime();d&&d!==a.currentState?(a.currentState=d,a.restoreFromState(c,function(){a._restoring=!1;b&&b();a=null},!1)):a.save(function(){a._restoring=!1;a=null;b&&b(!1);b=null})});return this},save:function(b,a,c){var d=this,c=c||{};if(!0===this.initialized&&!this._saveDisabled)if(!0===a)this.currentSaveTimer&&
(clearTimeout(this.currentSaveTimer),delete this.currentSaveTimer),this.getStateObj(function(a){var g=puredom.json(a),h=(new Date).getTime(),j=h-(d._lastSaveTime||h);d._lastSaveTime=h;g!==d.currentState?(d.currentState=g,d.adapter.setState(a,function(a){b&&"function"===puredom.typeOf(b)&&b(!!a);d=b=c=null},{replace:!0===c.replace||d.replaceTimeout&&0!==j&&j<d.replaceTimeout})):b&&"function"===puredom.typeOf(b)&&(b(),d=b=c=null)});else if(!this.currentSaveTimer)this.currentSaveTimer=setTimeout(function(){d.save(b,
!0,c);delete d.currentSaveTimer;d=b=c=null},this.saveQueueDelay);return this},setObjState:function(b,a,c){var d;c&&"object"===typeof c&&(d=c);this.states[b]=a;this.save(c,d&&!0===d.now||!0===c,d)},getObjState:function(b,a){this.states[b]=a},getStateObj:function(b){b&&b(this.states);return this},emptyFunc:function(){}});
puredom.StateManager.prototype.adapters.url={init:function(b){var a=this,c=this._doPoll,d=this._doPollTimed;this._doPoll=function(){return c.apply(a,arguments)};this._doPollTimed=function(){return d.apply(a,arguments)};this.usePreceedingSlash=!1!==b.usePreceedingSlash;this.urlMapping=b.urlMapping;this.urlHistory=[];if(b.html5UrlPrefix)this.html5UrlPrefix=b.html5UrlPrefix;if(b.beforeParse)this.beforeParse=b.beforeParse;if(b.beforeCommit)this.beforeCommit=b.beforeCommit},getPrefix:function(){return this.html5UrlPrefix?
"function"===typeof this.html5UrlPrefix?this.html5UrlPrefix():this.html5UrlPrefix:""},pollInterval:30,urlHistory:[],startPolling:function(){if(!this.polling)this.polling=!0,this.getCurrentUrl(!0),this.pollingTimer=setTimeout(this._doPollTimed,this.getPollInterval()),puredom.addEvent(window,"hashchange,pushstate,popstate",this._doPoll)},stopPolling:function(){clearTimeout(this.pollingTimer);puredom.removeEvent(window,"hashchange,pushstate,popstate",this._doPoll);this.polling=!1},getPollInterval:function(){return this.stateManager&&
(this.stateManager.pollInterval||this.stateManager.adapterPollInterval)||this.pollInterval},_doPoll:function(){var b=this,a=b.currentUrl||null,c=b.getCurrentUrl(!0)||null;c!==a&&((new Date).getTime(),b.stateManager.disableSave(),b.stateManager.restore(function(){b.stateManager.enableSave();b=a=c=null}))},_doPollTimed:function(){this._doPoll.apply(this,arguments);this.pollingTimer&&clearTimeout(this.pollingTimer);if(this.polling)this.pollingTimer=setTimeout(this._doPollTimed,this.getPollInterval())},
normalizeUrl:function(b){return(this.usePreceedingSlash?"/":"")+b.replace(/^[#!\/]+/gm,"").replace(/#.+$/gm,"")},getCurrentUrl:function(b){var a=location.href+"",c=a.indexOf("#!"),d=a.indexOf(location.host+"/");-1<c?(a=a.substring(c+2),window.history.replaceState&&window.history.replaceState(null,null,a)):a=-1<d?a.substring(d+location.host.length+1):null;a&&(a=this.normalizeUrl(a));if(!0===b)a!==this.currentUrl&&this.urlHistory[this.urlHistory.length-1]!==a&&this.urlHistory.push(a),this.currentUrl=
a;return a||!1},setCurrentUrl:function(b,a){var c=this.getCurrentUrl(!1),d,e,b=this.normalizeUrl(b);d="#!"+b;e=0<this.urlHistory.length&&this.urlHistory[this.urlHistory.length-1]===b;if(b!==c&&!e){if(window.history.pushState)"/"!==b.substring(0,1)&&(b="/"+b),c=this.getPrefix().replace(/\/$/,""),b=c+b,this.beforeCommit&&(b=this.beforeCommit(b)||b),!0===a&&window.history.replaceState?window.history.replaceState(null,null,b):window.history.pushState(null,null,b);else if(window.location.href!==d)!0===
a&&window.location.replace?window.location.replace(d):window.location.href=d;this.getCurrentUrl(!0)}},setState:function(b,a,c){(location.href+"").indexOf("#!");this.getCurrentUrl(!1);c=c||{};this.setCurrentUrl(this.stringify(b),!0===c.replace);a(!0)},getState:function(b){var a=this.getCurrentUrl(!0);a?(a=this.parse(a),b(a)):b(!1)},parse:function(b){var a={},c,d,e,g,h,j,f,m;f=function(a){return!!a.match(/^\-?[0-9]+$/)};m=function(a){if("undefined"===a)a=void 0;else if("null"===a)a=null;else if(a.match(/^\-?[0-9]+$/))a=
parseInt(a,10);else if(a.match(/^\-?[0-9\.]+$/))a=parseFloat(a);else if(a.match(/^(true|false)$/i))a="true"===a.toLowerCase();else if(a.match(/^\[[a-z0-9%_\-]+(,[a-z0-9%_\-]+)*\]$/))for(var a=a.substring(1,a.length-1).split(","),b=0;b<a.length;b++)a[b]=m(a[b]);return a};if(this.beforeParse&&((c=this.beforeParse(b))||""===c))b=c;(c=this.getPrefix())&&b.substring(0,c.length)===c&&(b=b.substring(c.length));!1!==this.usePreceedingSlash&&"/"===b.charAt(0)&&(b=b.substring(1));e=b.indexOf("?");if(-1===e&&
-1===b.indexOf("="))e=b.length;this.urlMapping&&0<e&&(c=b.substring(0,e),b=encodeURIComponent(this.urlMapping)+"="+encodeURIComponent(c)+"&"+b.substring(e+1));"?"===b.substring(0,1)&&(b=b.substring(1));b=b.split("&");for(c=0;c<b.length;c++){d=b[c].indexOf("=");e=decodeURIComponent(b[c].substring(0,d));d=decodeURIComponent(b[c].substring(d+1));g=decodeURIComponent(d);if(e.match(/\[\]$/g)){e=e.substring(0,e.length-2);g=g.split(",");for(d=0;d<g.length;d++)g[d]=decodeURIComponent(g[d])}else g=m(g);e=
e.split(".");j=a;for(d=0;d<e.length;d++)h=e[d],f(h)&&(h=parseInt(h.replace(/[^0-9]/,""),10)),d<e.length-1?(j[h]||(j[h]=f(e[d+1])?[]:{}),j=j[h]):j[h]=g}return a},stringify:function(b){var a="",c,d="",e=this.urlMapping;c=function(b,h){var j,f;switch(puredom.typeOf(b)){case "object":for(j in b)b.hasOwnProperty(j)&&c(b[j],(h?h+".":"")+j);break;case "array":f=!0;for(j=0;j<b.length;j++)t=puredom.typeOf(b[j]),"string"!==t&&"number"!==t&&"boolean"!==t&&(f=!1);if(f){a+="&"+encodeURIComponent(h)+"[]=";for(j=
0;j<b.length;j++)a+=(0<j?",":"")+encodeURIComponent(b[j])}else for(j=0;j<b.length;j++)c(b[j],(h?h+".":"")+j);break;case "null":case "undefined":case "function":break;default:e&&h===e?d=b:a+="&"+encodeURIComponent(h)+"="+encodeURIComponent(b)}};c(b);c=b=null;"&"===a.substring(0,1)&&(a="?"+a.substring(1));!1!==this.usePreceedingSlash&&"/"!==d.charAt(0)&&(d="/"+d);return d+a}};
puredom.StateManager.prototype.adapters.urlbasic={setState:function(b,a){var c=location.href+"",d=c.indexOf("#!");-1<d&&(c=c.substring(0,d));c+="#!"+this.serializeState(b);location.href=c;a(!0)},getState:function(b){var a=location.href+"",c=a.indexOf("#!");-1<c?(a=a.substring(c+2),a=puredom.json.parse(a),b(a)):b(!1)},serializeState:function(b){return puredom.json.stringify(b)}};
puredom.StateManager.prototype.adapters.cookies={init:function(b){b=b||{};this.dbName=b.dbName||"state"},setState:function(b,a){puredom.cookies.set(this.dbName,puredom.json.stringify(b));a(!0)},getState:function(b){var a=puredom.cookies.get(this.dbName),a=puredom.json.parse(a);b(a)},serializeState:function(b){return puredom.json.stringify(b)}};
puredom.RouteManager=function(b){var a=this;puredom.ControllerManager.call(this);this.allowTemplateFallback=!0===b.allowTemplateFallback||!0===b.useBest;this.allowPartialUrlFallback=!0===b.allowPartialUrlFallback;this._controllerUpdateState=function(b){a.doStateUpdate(a._routerState,b)}};
puredom.extend(puredom.RouteManager.prototype,{singular:!0,rewrites:[],restoreState:function(b){!0!==this.initialized?this._initState=b:b&&b.current_url?this.route(b.current_url):this.routeDefault()},doStateUpdate:function(b,a){var c;this._routerState=b&&puredom.extend({},b);if(b&&b.current)c=this.get(b.current),delete b.current,c=this._templateUrl(c.customUrl||c.urlTemplate||c.name,c),"/"!==c.substring(0,1)&&(c="/"+c),b.current_url=c;this.updateState(b,a)},register:function(b,a){a.updateState=this._controllerUpdateState;
return puredom.ControllerManager.prototype.register.call(this,b,a)},route:function(b){var a=this._controllers,c=b.replace(/^[#!\/]+/gm,"").replace(/#.+$/gm,""),d,e,g,h,j,f;for(e=0;e<a.length;e++){d=a[e];h=d.customUrl||d.urlTemplate||d.name;j={};if(!0===this._checkUrlMatch(h,b,j)){b={};for(g in j)"params."===(g+"").substring(0,7)&&(b[g.substring(7)]=j[g]);return this.load(d.name,{params:b})}if(!0===this.allowPartialUrlFallback&&!0===this._checkUrlMatch(h,b,j,{partial:!0}))f=d.name}if(f)return this.load(f,
{params:{}});if(!1!==this.allowTemplateFallback&&this.get(c))return this.load(c,{params:{}});this._fireEvent("routingError",[{attemptedFallback:!1!==this.allowTemplateFallback,url:b,type:"RoutingError"}]);return!1},routeDefault:function(){return this.loadDefault()},_templateUrl:function(b,a){a=a||this.current();return puredom.template(b,a,!1)},_checkUrlMatch:function(b,a,c,d){var b=this._getUrlSegments(b),a=this._getUrlSegments(a),e=/^\{([^{}]+)\}$/gim,g=!0,d=d||{},c=c||{};if(!0===d.partial)for(d=
b.length;d--;)b[d].match(e)&&b.splice(d,1);if(a.length===b.length)for(d=0;d<a.length;d++)if(a[d]===b[d]||b[d].match(e))c[b[d].replace(e,"$1")]=a[d];else{g=!1;break}else g=!1;return g},_getUrlSegments:function(b){var b=(b+"").split("/"),a;for(a=b.length;a--;)0===b[a].replace(/(\s|\/)/gm,"").length&&b.splice(a,1);return b}});puredom.inherits(puredom.RouteManager,puredom.ControllerManager);(function(){this.puredom=this.puredom||{}})();
puredom.Notifier=function(b){var a=this;puredom.EventEmitter.call(this);this._data={counter:0,list:{}};this._notificationClickHandler=function(b){a._performAction(puredom.el(this).attr("data-notification-id"),"notificationclick",b);return puredom.cancelEvent(b)};b=b||{};b.parent&&this._createBase(b.parent)};
puredom.extend(puredom.Notifier.prototype,{show:function(b){var a;return b?(this._data.counter+=1,a={id:this._data.counter+"",timeout:b.timeout||this.timeout},this._data.list[a.id]=a,a.base=this._build(a.id,b),this._show(a.id),a.timeout&&this._resetTimeout(a.id),a):!1},_createBase:function(b){this.notifications_base?(this.notifications_base.remove(),this.notifications_base.appendTo(b)):this.notifications_base=puredom.el({className:"notifications_base"},b)},_build:function(b,a){var c,d;c=puredom.el({className:"notification",
css:"height:0; opacity:0;",attributes:{"data-notification-id":b},children:[{className:"notification_top"},{className:"notification_inner",children:[{className:"notification_inner_top"},{className:"notification_closeButton",children:[{className:"label",innerHTML:this.closeButtonLabel||"&times;"}]},{className:"notification_message",children:[{className:"label",innerHTML:a.message||a.text}]},{className:"notification_inner_bottom"}]},{className:"notification_bottom"}],onclick:this._notificationClickHandler},
this.notifications_base);d=a.icon||a.image;if(!1!==d&&this.defaultIcon)d=this.defaultIcon;d&&puredom.el({type:"img",className:"notification_message",attributes:{src:a.icon||a.image||this.defaultIcon}},c.query(".notification_inner"));!1===a.userDismiss&&c.query(".notification_closeButton").hide(!0);return c},_show:function(b){(b=this.get(b))&&b.base.css({opacity:0}).css({opacity:1,height:b.base.children().height()},{tween:this.showTween||"medium"})},_hide:function(b){var a=this.get(b);a&&a.base.css({opacity:0,
height:0},{tween:this.hideTween||"medium",callback:function(){a.base.remove();a=null}})},_resetTimeout:function(b){var a=this.get(b),c=this;if(a){a._hideTimer&&clearTimeout(a._hideTimer);if(a.timeout)a._hideTimer=setTimeout(function(){c._hide(b);c=b=null},1E3*a.timeout);a=null}},get:function(b){return b&&this._data.list.hasOwnProperty(b+"")&&this._data.list[b+""]||!1},_performAction:function(b,a,c){var d=this.get(b);puredom.isArray(c)||(c=[c]);if(a&&d&&(c=[b].concat(c),c=this._fireEvent(a,c),!1!==
c))switch(a.toLowerCase()){case "notificationclick":case "notificationclicked":this._hide(b)}},timeout:15,_data:{counter:0,list:{}}});puredom.inherits(puredom.Notifier,puredom.EventEmitter);window.puredom=window.puredom||{};
puredom.net={HttpRequest:function(b){puredom.extend(this,b)},get:function(b,a,c){return this.request(puredom.extend({url:b,type:"GET",callback:a},c||{}))},post:function(b,a,c,d){return this.request(puredom.extend({url:b,type:"POST",post:a,callback:c},d||{}))},multiLoad:function(b,a){if(!b)return!1;var c=-1,d=b.length,e=[],g,h;g=function(d,f){if(d&&f){var m=b[c],v=f;m.process&&m.process.call&&(v=m.process(v),void 0===v&&(v=f));e.push(v);a&&a(!1,e,0,0);g=h=b=e=a=null}else h()};h=function(){c+=1;var e=
b[c];(e="string"===typeof e?{url:e}:e)?http.request(e,g):c<d?h():a(!1,null,null,"No resources were available.")};h();return!0},request:function(b,a){var c,d,e;if(!b.url)return!1;e=this;b=b||{};c=new puredom.net.HttpRequest({url:b.url,type:b.type||(b.post?"POST":"GET"),callback:b.callback||a||function(){},post:b.post,headers:b.headers});if(b.contentTypeOverride)c.contentTypeOverride=b.contentTypeOverride,delete b.contentTypeOverride;this.createXHR(c.url,function(a){c.request=a.xhr;c._xdrFrame=a.frame;
a=null;if(c.post&&"object"===puredom.typeOf(c.post)&&(c.post=puredom.parameterize(c.post),"?"===c.post.substring(0,1)))c.post=c.post.substring(1);c.request.onreadystatechange=function(){var a;if(c.request._orig)c.request.readyState=c.request._orig.readyState,c.request.status=c.request._orig.status,c.request.responseText=c.request._orig.responseText,c.request.responseXML=c.request._orig.responseXML;if(4===c.request.readyState){c._xdrFrame&&setTimeout(function(){e._freeIframes.push(c._xdrFrame);e=null},
100);c.status=c.request.status;if(c.contentTypeOverride)a=c.contentTypeOverride.toLowerCase();else{try{a=c.request.getResponseHeader("Content-Type").toLowerCase()}catch(b){}a=a||""}c.responseText=c.request.responseText;if(a.match(/\/(json|javascript)$/gm)||"json"===a){c.responseType="json";a=c.responseJSON=null;try{a=c.responseJSON=JSON.parse(c.request.responseText.replace(/^[^\[\{]*(.*)[^\[\{]*$/g,"$1"))}catch(d){c.jsonParseError=!0}}else"application/xml"===a||"xml"===a?(c.responseType="xml",a=c.responseXML=
c.request.responseXML):(c.responseType="text",a=c.responseText);c.callback&&c.callback(300>c.request.status,a)}};c.request.open(c.type,c.url,!1!==c.async);c.request.setRequestHeader("content-type","application/x-www-form-urlencoded");c.request.setRequestHeader("x-requested-with","XMLHttpRequest");if(c.headers)for(d in c.headers)if(c.headers.hasOwnProperty(d))try{c.request.setRequestHeader(d,c.headers[d])}catch(b){}c.request.send(c.post||null)});return c},jsonp:function(){var b=function(){return b.get.apply(b,
arguments)},a=0;b.get=function(b,d,e){var g,h,j,f;"function"===puredom.typeOf(d)&&(e&&"object"===puredom.typeOf(e)&&(f=e),e=d,f&&(d=f));d=d||{};if(d.callback&&!e)e=d.callback;if(!d.timeout)d.timeout=10;b=b||d.url;if(!b)return!1;d.params&&puredom.parameterize&&(b+=(-1<b.indexOf("?")?"&":"?")+puredom.querystring.stringify(d.params));a+=1;d.callback=j="puredom_net_jsonp_"+a;(function(){window[d.callback]=function(a){var b;if(e){try{e(a)}catch(c){b=c}e=null}h&&(h.stop(),h=null);if(b)throw b;}})();b=-1<
b.indexOf("{!callback}")?b.replace("{!callback}",j):b+((0>b.indexOf("?")?"?":"&")+encodeURIComponent(d.callbackParam||"callback")+"="+encodeURIComponent(j));if(!this._head)this._head=(f=document.getElementsByTagName("head"))&&f[0];g=puredom.el({type:"script",attributes:{src:b,async:"async",type:"text/javascript"},parent:this._head||document.body});h={id:j,stop:function(){h._timer&&clearTimeout(h._timer);window[j]=null;try{delete window[j]}catch(a){}e=null;g.attr("src","about:blank").remove();j=h=
g=null}};if(d.timeout&&0<d.timeout)h._timer=setTimeout(function(){e&&e({_requestTimedOut:!0,_jsonpTimedout:!0,success:!1,result:!1});h&&h.stop()},Math.round(1E3*d.timeout));b=d=f=null;return h};return b}(),_freeIframes:[],_xhrIndex:0,createXHR:function(b,a){var c=!1,d=this,e,g,h,j,f,m;this._xhrIndex+=1;if(b&&(e=(e=/^[a-z]{3,9}\:\/\/([^\/\?#]+)/gim.exec(b))&&e[1])&&e!==location.hostname){c=!0;document.domain=location.hostname.match(/[^.]+\.[^.]+$/gim)[0];for(m=0;m<this._freeIframes.length;m++)if(this._freeIframes[m].getAttribute("data-xhr-domain")===
e){g=this._freeIframes.splice(m,1)[0];break}g?a(d._createXHRObj(g.contentWindow,g)):(g=document.createElement("iframe"),g.style.cssText="position:absolute; left:0; top:-1000px; width:1px; height:1px; border:none; overflow:hidden;",j=function(){var b,c;try{c=(b=g.contentWindow)&&b.document&&b.document.domain===document.domain&&b.document.body}catch(m){c=null}if(c&&c.innerHTML)clearInterval(f),g.onload=g.onerror=null,a(d._createXHRObj(b,g)),d=a=h=g=e=j=f=null},g.onload=g.onerror=j,g.setAttribute("src",
location.protocol+"//"+e+"/xd_receiver.html"),g.setAttribute("role","presentation"),g.setAttribute("tabindex","-1"),g.setAttribute("data-xhr-domain",e),document.body.appendChild(g),f=setInterval(j,50))}if(!c)return h=this._createXHRObj(),a(h),h},_createXHRObj:function(b,a){var c,b=b||window;try{c=new b.XMLHttpRequest}catch(d){try{c=new b.ActiveXObject("Msxml2.XMLHTTP")}catch(e){c=new b.ActiveXObject("Microsoft.XMLHTTP")}}return{xhr:c,frame:a}}};window.puredom=window.puredom||{};
puredom.NativeAPI=function(b){var a=(this.constructor===arguments.callee?this:b)||{},c={},d={},e={},g,h,j,f={}.constructor,m,v,i,n,k=function(){},l;l=function(b){!1!==a.enableLogging&&window.console&&window.console.log&&window.console.log(b)};g=function(a){var b="",c,d;for(c in a)if(null!==a[c]&&void 0!==a[c]&&a[c].constructor!==Function&&a[c].constructor!==f&&"object"!==puredom.typeOf(a[c])&&!j(a[c]))b+="&"+encodeURIComponent(c)+"="+encodeURIComponent(a[c]);else if(a[c]&&j(a[c]))for(d=0;d<a[c];d++)b+=
"&"+encodeURIComponent(c)+"[]="+encodeURIComponent(a[c]);return b};h=function(a,b){var c,d,e;for(c=1;c<arguments.length;c++)for(d in e=arguments[c],e)e.hasOwnProperty(d)&&(a[d]=e[d]);return a};j=function(a){return"[object Array]"===Object.prototype.toString.apply(a)};v=function(){};a.MessageStringWithData=i=function(a,b){this.message=b||"";h(this,a)};i.prototype.toString=i.prototype.toSource=function(){return this.message};n=function(a,b){function c(){}var d;if(puredom.isArray(a.data)&&0===a.data.length)a.data=
{};h(c.prototype,{getData:function(){return puredom.extend({},this)},getResponse:function(){return this.constructor.prototype._originalResponse},_originalResponse:b});d=new c;h(d,a);return function(e){a=d=b=c=null;return e}(d)};a.setGlobalParameter=function(a,b){void 0===b||2>arguments.length?delete d[a]:d[a]=b};a.setAuthParameter=function(a,b){void 0===b||2>arguments.length?delete e[a]:e[a]=b};c.cache={};c.getCacheKey=function(a,b){var c="",d=[],e,f=[],b=puredom.extend({},b||{});delete b.callback;
c=(a.type||"")+"||"+a.endpoint+"||";for(e in b)b.hasOwnProperty(e)&&"_cache"!==e&&"_nocache"!==e&&"_cache_deleteonly"!==e&&"callback"!==e&&f.push(e);f.sort();for(e=0;e<f.length;e++)d.push(encodeURIComponent("o_"+f[e])+"="+encodeURIComponent(b[f[e]]+""));return c+=d.join("&")};c.getCached=function(b,d){var e=c.getCacheKey(b,d),e=c.cache.hasOwnProperty(e)?puredom.json.parse(c.cache[e]):null;!0===a.enableCacheLogging&&console.log("CACHE: Getting ["+b.type+"] "+b.endpoint,d," --\> ",e);return e};c.uncache=
function(b,d){var e=c.getCacheKey(b,d);!0===a.enableCacheLogging&&console.log("CACHE: Clearing ["+b.type+"] "+b.endpoint,d);delete c.cache[e]};c.cacheResponse=function(b,d,e){var f=c.getCacheKey(b,d);!0===a.enableCacheLogging&&console.log("CACHE: Storing ["+b.type+"] "+b.endpoint,d," --\> ",e);c.cache[f]=puredom.json.stringify(e)};a.clearCache=function(){!0===a.enableCacheLogging&&console.log("CACHE: Purging all entries");c.cache={}};c.validateParameters=function(a,b){var c,d,e,f,g,h,i={errors:[],
message:""},j={nativeApiError:!0,clientSideError:!0};if(b.parameters)for(d in c={},b.parameters)if(b.parameters.hasOwnProperty(d)){e=b.parameters[d];f=puredom.typeOf(e);if("function"===f&&e.name)f="string",e=e.name.toLowerCase();else if("regexp"===f||e.constructor===RegExp)f="string",e="/"+e.source+"/"+(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"");"string"===f&&("/"===e.substring(0,1)?(e=/^\/(.*?)\/([gim]*?)$/gim.exec(e),c[d]={validate:"regex",against:RegExp(e[1]||"",e[2]||"")}):c[d]=
{validate:"type",against:e.toLowerCase()})}if(c)for(d in c)if(c.hasOwnProperty(d)){f=c[d].validate;e=c[d].against;g=a[d];h=null;if("regex"===f)e.lastIndex=0;!a.hasOwnProperty(d)||null===g||void 0===g||""===g?h={field:d,type:"RequiredError",message:"{fieldnames."+d+"} is required"}:"regex"===f&&!e.test(g+"")?h={field:d,type:"ValidationError",message:"{fieldnames."+d+"} is invalid"}:"type"===f&&e!==puredom.typeOf(g)&&(h={field:d,type:"TypeError",message:"{fieldnames."+d+"} is invalid"});if(h)h.missingParameter=
h.field,i.message+=(0<i.message.length?", ":"")+h.message+" ("+h.type+")",i.errors.push(puredom.extend(h,j))}i.failed=0<i.errors.length;return i};m=function(m,v,q){a[m][v]=function(o){var w=c.validateParameters(o=o||{},q),u,D,F,s,z,E,G,A,C=!0===q.longPolling||!0===q.allowLongPolling&&!0===o.longPolling,H=o.hasOwnProperty("longPolling"),K=o.longPolling,J;if(w.failed)return l("api."+m+"."+v+": Errors: "+w.message,9),o.callback(!1,w.errors[0],w.errors),!1;u=function(d,e){var g=d&&(!0===d[b.statusProperty||
"success"]||1===d[b.statusProperty||"success"]),h=d.data||d||null,l=d.errorMessage||d.message||null,u=d[b.statusProperty||"success"],w,B,e=e||{};e.apiMethod=q.endpoint;!0!==e.cached&&!0===q.cache&&!0===a.enableCache&&c.cacheResponse(q,o,d);if(q.verifyResult)g=q.verifyResult(d);else if(!0!==u&&!1!==u&&0!==u&&1!==u||d.constructor!==f&&!j(d))g=d.constructor===f||j(d)?!0:!1,h=d,l=null;if(C&&g&&!0===d.timedout)return w=o,setTimeout(function(){a[m][v](w);w=g=d=h=l=u=null},1),!0;h=n(h,d,e);B=new i(d,l);
if(!0===e.parseError&&(g=!1,h=h.message||h,b.onParseError))b.onParseError(d,e);(q.onbeforecomplete||q.onBeforeComplete||q.precallback||k)(g,!0===g?h:B,d);!0===g?(o.onsuccess||q.onsuccess||k).call(b.endpoints[m][v],h,d):(o.onerror||q.onerror||k).call(b.endpoints[m][v],l,h,d);(o.oncomplete||o.callback||k).call(b.endpoints[m][v],g,!0===g?h:B,d);(q.oncomplete||q.onComplete||q.callback||k)(g,!0===g?h:B,d);if(b.onRequestCompleted)b.onRequestCompleted(m+"."+v,h,g,A,o);o=p=D=F=s=z=E=G=A=C=H=K=J=B=null};F=
q.type&&q.type.toLowerCase()||"";s=q.endpoint;q.formatSuffix?s+=q.formatSuffix:b.formatSuffix&&(s+=b.formatSuffix);s.match(/^(http|https|ftp)\:/)||(s=b.root+s);J=!1===o._cache||!0===o._nocache;if(C){o.longPolling=null;try{delete o.longPolling}catch(M){}o.timeout=o.timeout||q.longPollingTimeout||a.longPollingTimeout||60}else if(!0===q.cache&&!0===a.enableCache)if(J){if(c.uncache(q,o),!0===o._cache_deleteonly)return}else if(z=c.getCached(q,o)){setTimeout(function(){u(z,{cached:!0,fresh:!1})},1);return}o&&
(s=s.replace(/\{([a-z0-9\-\._]+)\}/gim,function(a,b){if(o.hasOwnProperty(b)&&null!==o[b]&&void 0!==o[b]){try{delete o[b]}catch(c){o[b]=null}return o[b]}return a}));switch(F){case "xdr":l("Cross-domain requests are not yet supported.",7);break;case "post":E={};for(z in o)if(o.hasOwnProperty(z)&&"[object Function]"===Object.prototype.toString.apply(o[z])){E[z]=o[z];o[z]=null;try{delete o[z]}catch(N){}}A=G=h({},d,!0===q.auth?e:{},q.defaultParameters||{},o);for(z in E)E.hasOwnProperty(z)&&(o[z]=E[z]);
E=null;puredom.net.request({url:s,type:"POST",post:G,callback:function(a,b){a&&b?u(b):!0===this.jsonParseError?u({status:!1,message:"Unable to parse server response",rawdata:this.responseText},{parseError:!0,clientsideErrorDetection:!0}):u({status:!1,message:"Connection error "+this.status},{clientsideErrorDetection:!0})},contentTypeOverride:"application/json"});break;case "jsonp":A=h({},d,!0===q.auth?e:{},q.defaultParameters||{},o);s+=g(A);if(-1===s.indexOf("?")||s.indexOf("?")>s.indexOf("&"))s=
s.replace("&","?");D=puredom.net.jsonp(s,u);break;default:A=h({},d,!0===q.auth?e:{},q.defaultParameters||{},o);s+=g(A);if(-1===s.indexOf("?")||s.indexOf("?")>s.indexOf("&"))s=s.replace("&","?");puredom.net.request({url:s,type:"GET",callback:function(a,b){a&&b?u(b):!0===this.jsonParseError?u({status:!1,message:"Unable to parse server response",rawdata:this.responseText},{parseError:!0,clientsideErrorDetection:!0}):u({status:!1,message:"Connection error "+this.status},{clientsideErrorDetection:!0})},
contentTypeOverride:"application/json"})}if(H)o.longPolling=K;return D}};a.constructor==={}.constructor&&(a=function(a){function b(){}for(var c in a)a.hasOwnProperty(c)&&(b.prototype[c]=a[c]);return new b}(a));var C,H;for(C in b.endpoints)if(b.endpoints.hasOwnProperty(C))for(H in a[C]=new v,b.endpoints[C])b.endpoints[C].hasOwnProperty(H)&&m(C,H,b.endpoints[C][H]);if(a.globalParameters)for(var u in a.globalParameters)a.globalParameters.hasOwnProperty(u)&&a.setGlobalParameter(u,a.globalParameters[u]);
if(this.constructor!==arguments.callee)return a};window.puredom=window.puredom||{};puredom.LocalStorage=function(b,a,c){var d=this,c=c||{};this.id=b;this.adapter=null;this.data={};c.adapter&&this.setAdapter(c.adapter);!this.adapter&&!1!==c.useBest&&this.useBestAdapter();this.adapter&&!1!==c.restore?this.restore(function(){a&&a(d);d=c=null}):a&&(a(d),d=null)};puredom.LocalStorage.prototype.commitDelay=100;puredom.LocalStorage.prototype.data={};
puredom.LocalStorage.prototype.setAdapter=function(b){var a=this.constructor.adapters,c=(b+"").toLowerCase(),d=!1,e=!1,g;for(g in a)if(a.hasOwnProperty(g)&&(g+"").toLowerCase()===c&&(d=!0,!0===a[g].test(this))){e=!0;this.adapterName=b;this.adapter=a[g];break}if(!d)return puredom.log('puredom.LocalStorage :: Could not find "'+b+'" adapter.'),!1;return!e?(puredom.log('puredom.LocalStorage :: "'+b+'" adapter test() failed: conditions for adapter use not met.'),!1):!0};
puredom.LocalStorage.prototype.getAdapter=function(){return this.adapterName};puredom.LocalStorage.prototype.useBestAdapter=function(){var b=this.constructor.adapters,a,c,d;for(d in b)if(b.hasOwnProperty(d)&&!0===b[d].test(this)&&(!a||(Math.round(a.rating)||0)<(Math.round(b[d].rating)||0)))a=b[d],c=d;if(a)this.adapterName=c,this.adapter=a;else return setTimeout(function(){throw"puredom.LocalStorage :: Could not find the best adapter.";},1),!1;return!0};
puredom.LocalStorage.prototype.getNamespace=function(b){var a=this,c,b=b+"";"."===b.substring(0,1)&&(b=b.substring(1));"."===b.substring(b.length-1)&&(b=b.substring(0,b.length-1));c=puredom.extend(new puredom.LocalStorage.NamespacedLocalStorage,{getAdapter:function(){return a.getAdapter()},getNamespace:this.getNamespace,getValue:function(c){return a.getValue(b+"."+c)},setValue:function(c,e){a.setValue(b+"."+c,e);return this},removeKey:function(c){a.removeKey(b+"."+c);return this},purge:function(){a.removeKey(b);
return this},getData:function(){return a.getValue(b)},restore:function(b){var c,g=this;b&&(c=function(){b(g);g=c=b=null});a.restore(c);return this},commit:function(b){var c,g=this;b&&(c=function(){b(g);g=c=b=null});a.commit(c);return this}});puredom.extend(c,{get:c.getValue,set:c.setValue,remove:c.removeKey});return c};puredom.LocalStorage.prototype.getData=function(){return this.data};puredom.LocalStorage.prototype.getValue=function(b){return puredom.delve(this.data,b)};
puredom.LocalStorage.prototype.setValue=function(b,a){var c=this.data,d=b.split("."),e;for(e=0;e<d.length-1;e++)c.hasOwnProperty(d[e])||(c[d[e]]={}),c=c[d[e]];void 0===a||null===a?(c[d[d.length-1]]=null,delete c[d[d.length-1]]):c[d[d.length-1]]=a;this.queueCommit();return this};puredom.LocalStorage.prototype.removeKey=function(b){this.setValue(b,void 0);return this};puredom.LocalStorage.prototype.get=puredom.LocalStorage.prototype.getValue;puredom.LocalStorage.prototype.set=puredom.LocalStorage.prototype.setValue;
puredom.LocalStorage.prototype.remove=puredom.LocalStorage.prototype.removeKey;puredom.LocalStorage.prototype.purge=function(){this.data={};this.queueCommit();return this};puredom.LocalStorage.prototype.restore=function(b){var a=this,c,d;if((c=this._adapterCall("load",function(c){a.data=d=c||{};b&&b(a);a=null}))&&!d)this.data=c,b&&b(this);c=d=null;return this};
puredom.LocalStorage.prototype.commit=function(b){var a=this;if(this._commitTimer)clearTimeout(this._commitTimer),this._commitTimer=null;this._adapterCall("save",this.data,function(){b&&b(a);a=null});return this};puredom.LocalStorage.prototype.queueCommit=function(){var b=this;if(!this._commitTimer)this._commitTimer=setTimeout(function(){b.commit();b=null},this.commitDelay)};
puredom.LocalStorage.prototype._adapterCall=function(b,a){if(this.adapter&&this.adapter[b])return this.adapter[b].apply(this.adapter,[this].concat(puredom.toArray(arguments).slice(1)))};puredom.LocalStorage.NamespacedLocalStorage=function(){};puredom.LocalStorage.adapters={};
puredom.LocalStorage.addAdapter=function(b,a){if(a.save)if(a.load)this.adapters[b]=a;else throw'puredom.LocalStorage :: Adapter "'+b+'" attempted to register, but does not provide a load() method.';else throw'puredom.LocalStorage :: Adapter "'+b+'" attempted to register, but does not provide a save() method.';};window.puredom=window.puredom||{};
puredom.i18n=function(){var b={},a;a=function(){return a.localize.apply(this,arguments)};a.getLang=function(a){var a=a.toLowerCase().replace(/[^a-z0-9]/gim,""),d;for(d in b)if(b.hasOwnProperty(d)&&(d+"").toLowerCase().replace(/[^a-z0-9]/gim,"")===a)return b[d];return!1};a.hasLang=function(b){return!!a.getLang(b)};a.setLang=function(b){if(a.hasLang(b))a.locale=a.lang=b;return this};a.localizeDOM=function(b){b.query("[data-i18n-id]").each(function(b){var c=(b.attr("data-i18n-id")||"")+"",g=b.nodeName(),
h;if(c&&0<c.length&&(h=a.localize(c,null,""))&&h!==c&&""!==h)switch(g){case "select":case "input":case "textarea":c=b.value();c!==h&&b.value(h);break;default:c=b.html(),c!==h&&b.html(h)}})};a.localize=function(c,d,e,g){var h=puredom.typeOf(c),j=c,f,m,g=g||{},d=(d||a.lang||a.locale||"en").toUpperCase();b.hasOwnProperty(d)?f=b[d]:-1<d.indexOf("-")&&(d=d.substring(0,d.indexOf("-")),b.hasOwnProperty(d)&&(f=b[d]));if(f&&null!==c&&void 0!==c)if("string"===h&&(c=c.replace(/\{([^{}]+)\}/gim,"$1")),f={labels:f.labels||
{},formats:f.formats||{}},"string"===h&&!c.match(/^(labels|formats)\./gim)&&(c="labels."+c),"date"===h||c.constructor===Date)m=(f=f.formats[g.datetype||"date"])&&puredom.date.format(c,f)||c.toLocaleString();else if("number"===h){if(f.formats.thousands_separator){m="";for(c+="";0<c.length;)m=c.substring(Math.max(0,c.length-3))+m,3<c.length&&(m=f.formats.thousands_separator+m),c=c.substring(0,Math.max(0,c.length-3))}}else m="boolean"===h?(!0===c?f.formats.booleanTrue:f.formats.booleanFalse)||c+"":puredom.delve(f,
c+"");return m?m:null!==e&&void 0!==e?e:j};a.addLang=function(a,d){a=(a+"").toUpperCase();d.labels||(d={labels:d});b[a]=d;return this};puredom.addNodeSelectionPlugin("localize",function(){a.localizeDOM(this);return this});return a}();
puredom.FormHandler=function(b,a){var c=this,a=a||{};if(1===arguments.length&&"object"===typeof b&&b.constructor!==puredom.NodeSelection)a=b,b=a.form;puredom.EventEmitter.call(this);this._customTypes=[].concat(this._customTypes);b&&this.setForm(b);!0===a.enhance&&this.enhance();a.data&&this.setData(a.data);if(a.onsubmit&&"function"===typeof a.onsubmit)this.on("submit",a.onsubmit),this._constructorSubmitHandler=a.onsubmit;if(a.oncancel&&"function"===typeof a.oncancel)this.on("cancel",a.oncancel),this._constructorCancelHandler=
a.oncancel;if(a.submitButton&&"on"in a.submitButton)a.submitButton.on("click",this._defaultSubmitButtonHandler),this._constructorSubmitButton=a.submitButton;if(a.cancelButton&&a.cancelButton.on)a.cancelButton.on("click",function(a){c.cancel();return puredom.cancelEvent(a)}),this._constructorCancelButton=a.cancelButton};
puredom.extend(puredom.FormHandler.prototype,{errorMessageSelector:".errorMessage, .generalForm_errorMessage",setForm:function(b){var a=this;this.form=puredom.el(b);if(!this.action)this.action=this.form.attr("action");if(!this.method)this.method=this.form.attr("method");puredom.el({type:"input",attributes:{type:"submit"},css:"position:absolute; left:0; top:-999em; width:1px; height:1px; font-size:1px; visibility:hidden;"},this.form);this.form.on("submit",function(b){a.submit();return b.cancel()});
this._kill=function(){a=null};return this},enhance:function(){var b=this,a=this._getFields();a&&a.each(function(a){var d=b._getCustomType(a);d&&d.enhance&&d.enhance(a)});b=a=null;return this},disable:function(){this.disabled=!0;this._getFields().disable();return this},enable:function(){this.disabled=!1;this._getFields().enable();return this},destroy:function(){var b=this,a=this._getFields();a&&a.each(function(a){var d=b._getCustomType(a);d&&d.destroy&&d.destroy(a)});this._constructorSubmitHandler&&
this.removeEventListener("submit",this._constructorSubmitHandler);this._constructorSubmitButton&&this._constructorSubmitButton.removeEvent("click",this._defaultSubmitButtonHandler);this._constructorCancelHandler&&this.removeEventListener("cancel",this._constructorCancelHandler);this._constructorCancelButton&&this._constructorCancelButton.removeEvent("click",this._constructorCancelHandler);b=a=null;return this},clear:function(){this.setData({},!0);this.clearErrors();return this},reset:function(){return this.clear.apply(this,
arguments)},submit:function(){var b;if(!0===this.disabled)return puredom.log("Notice: Not submitting disabled form."),this;this.clearErrors(!1);b=this.getData();this._hasErrors=!1;b=b?this._fireEvent("submit",[b]):this._fireEvent("submitfailed",[b]);!this._hasErrors&&(!b||!0!==b.falsy)&&this.clearErrors();return this},cancel:function(){if(!0===this.disabled)return puredom.log("Notice: Not cancelling on disabled form."),this;this.clearErrors();this._fireEvent("cancel");return this},clearErrors:function(b){this._getFields().each(function(a){a.parent().declassify("error")});
if(!1!==b)this._hasErrors=!1,this.form.query(this.errorMessageSelector).first().css({height:0,opacity:0},{tween:"fast",callback:function(a){a.hide()}})},showFieldErrors:function(b){var a=this;this._hasErrors=!0;puredom.forEach(b,function(b,d){var e,b=((b||"Error")+"").replace(/\{fieldnames\.([^\}]+)\}/gim,function(b,c){var d=c&&a.form.query('[name="'+c+'"]').attr("id");return(d=d&&a.form.query('label[for="'+d+'"]'))&&d.exists()?(d._nodes[0].textContent||d._nodes[0].innerText||d._nodes[0].innerHTML||
"").replace(/\:\s*?$/g,""):c});a.form.query('[name="'+d+'"]').focus().parent().classify("error");-1===b.indexOf(" ")&&(b=puredom.i18n(b.toUpperCase()));e=a.form.query(a.errorMessageSelector).first();e.html('<div class="formHandlerErrorMessage">'+b+"</div>");e.css({height:Math.round(e.prop("offsetHeight"))||0,opacity:0}).show().css({height:e.children().first().height()+"px",opacity:1},{tween:"medium"});return!1});a=null},getData:function(){var b=null,a=this,c=this._getFields();c&&(b={},c.each(function(c){var e=
c.attr("name");e&&(b[e]=a._getInputValue(c))}));a=c=null;return b},setData:function(b,a){var c=[],d=this,e=this._getFields();b&&e&&e.each(function(e){var h=e.attr("name");b.hasOwnProperty(h)?(c.push(h),d._setInputValue(e,b[h])):!0===a&&d._setInputValue(e,null)});d=e=null;return this},addCustomType:function(b){var a=this,c=this._getFields();this._customTypes.push(b);c&&b.enhance&&c.each(function(c){var e=a._getCustomType(c);e===b&&e.enhance(c)});a=c=null;return this},_getFields:function(){var b=null;
this.form&&(b=this.form.query("input,textarea,select"));return b},_setInputValue:function(b,a){var c=this._getCustomType(b);if(void 0===a||null===a)a="";c&&c.setValue?c.setValue(b,a):b.value(a);return this},_getInputValue:function(b){var a=this._getCustomType(b);return a&&a.getValue?a.getValue(b):b.value()},_getCustomType:function(b){var a,c,d;b.attr("customtype")?a=(b.attr("customtype")+"").toLowerCase():b.attr("type")&&(a=(b.attr("type")+"").toLowerCase());c=(b.prop("nodeName")+"").toLowerCase();
for(b=0;b<this._customTypes.length;b++)if(d=this._customTypes[b],d.types&&-1<this._arrayIndexNC(d.types,a)||d.type&&(d.type+"").toLowerCase()===a||d.nodeNames&&-1<this._arrayIndexNC(d.nodeNames,c)||d.nodeName&&(d.nodeName+"").toLowerCase()===c)return d;return!1},_arrayIndexNC:function(b,a){for(var a=(a+"").toLowerCase(),c=0;c<b.length;c++)if((b[c]+"").toLowerCase()===a)return c;return-1},_defaultSubmitButtonHandler:function(b){var a=puredom.el(this);do if("form"===a.nodeName()){a.submit();break}while((a=
a.parent()).exists()&&"body"!==a.nodeName());return puredom.cancelEvent(b)},_customTypes:[]});puredom.inherits(puredom.FormHandler,puredom.EventEmitter);puredom.FormHandler.addCustomType=function(b){this.prototype._customTypes.push(b)};window.puredom=window.puredom||{};
puredom.date={now:Date.now?function(){return Date.now()}:function(){return+new Date},create:function(b){b?(b=(b+"").replace(/^([0-9]{4})\-([0-9]{2})\-([0-9]{2})T([0-9]{2})\:([0-9]{2})\:([0-9]{2})\.[0-9]{3}Z$/,"$1/$2/$3 $4:$5:$6"),b=new Date(b)):b=new Date;return b},parse:function(b,a){var c,d,e,g,h;function j(a,b){if(!1===b||!0===b)c=!0===b;if(a||0===a)d=a;a=d;12>d&&c&&(a-=12);var e=f.getDate();12===d&&!1===c?(0!==f.getHours()||b===!!b)&&f.setHours(0):(f.setHours(a),f.setDate(e))}var a=a||"%d/%m/%Y",
f=new Date(0);c=void 0;d=void 0;e=void 0;g=void 0;h=void 0;var m={H:[/^[0-9]{1,2}/g,function(a){a=Math.round(a);j(a)}],I:[/^[0-9]{1,2}/g,function(a){a=Math.round(a);j(a)}],p:[/^[AP]M/gi,function(a){j(null,"pm"===a.toLowerCase())}],M:[/^[0-9]{1,2}/g,function(a){f.setMinutes(Math.round(a))}],a:[/^(Mon|Tue(s?)|Wed|Thu|Fri|Sat|Sun)/i,function(){}],A:[/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday)/i,function(){}],d:[/^[0-9]{1,2}/g,function(a){e=Math.round(a);f.setDate(e)}],m:[/^[0-9]{1,2}/g,
function(a){g=Math.round(a)-1;f.setMonth(g)}],B:[RegExp("^("+this.months.join("|")+")","gi"),function(a){g=date._getMonthIndex(a);f.setMonth(g)}],b:[/^(Jan|Feb|Mar|Apr|May|Jun(e?)|Jul(y?)|Aug|Sep(t?)|Oct|Nov|Dec)/gi,function(a){g=date._getMonthIndex(a);f.setMonth(g)}],y:[/^[0-9]{2}/g,function(a){a=Math.round(a)+1900;1950>a&&(a+=100);f.setFullYear(a)}],Y:[/^[0-9]{4}/g,function(a){h=Math.round(a);f.setFullYear(h)}]},v,i,n;m.l=m.I;m.e=m.d;m.P=m.p;m.h=m.b;for(v=0;v<a.length;v++)if("%"===a.charAt(v))for(n in i=
null," "===b.charAt(0)&&"%"===a.charAt(v)&&(b=b.substring(1)),m){if(m.hasOwnProperty(n)&&a.substring(v+1,v+1+n.length)===n){i=m[n];b=b.replace(i[0],function(a){i[1](a);return""});v+=i.length-1;break}}else b.charAt(0)===a.charAt(v)&&(b=b.substring(1));(g||0===g)&&f.setMonth(g);(h||0===h)&&f.setFullYear(h);return f},unformat:function(){return this.parse.apply(this,arguments)},format:function(b,a){a=a||"%d/%m/%Y";if(!b||b.constructor!==Date||!b.toDateString)return!1;var c=b.toDateString();if(!c||"invalid date"===
c.toLowerCase())return!1;if("NaN"===c)return!1;var c=c.split(" "),d=b.getHours(),e=(d+11)%12+1,g=b.getMonth()+1,h={H:d,I:(10>e?"0":"")+e,l:e,p:11<d?"PM":"AM",P:11<d?"pm":"am",M:(10>b.getMinutes()?"0":"")+b.getMinutes(),S:(10>b.getSeconds()?"0":"")+b.getSeconds(),a:c[0],A:this.weekdays[b.getDay()],d:c[2],e:Math.round(c[2]),m:(10>g?"0":"")+g,B:this.months[Math.round(c[1])],b:c[1],h:c[1],y:c[3].substring(2),Y:c[3]};return a.replace(/%[HIlpPMSaAdemBbhyY]/gm,function(a){var b=h[a.charAt(1)+""];return b||
0===b||!1===b?b:a})},_getMonthIndex:function(b){for(var b=b.substring(0,3).toLowerCase(),a=0;a<this.months.length;a++)if(this.months[a].substring(0,3).toLowerCase()===b)return a;return-1},weekdays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),months:"January,February,March,April,May,June,July,August,September,October,November,December".split(",")};
puredom.LocalStorage.addAdapter("WebkitSQLite",{defaultName:"db",dbInfo:{name:"PureDOMLocalStorage",table:"storage",version:"1.0",displayName:"Cache, Settings and Storage",quota:2E5,minimumQuota:1E4},rating:80,test:function(){return!!window.openDatabase},load:function(b,a){var c=this._getDatabase(b),d=this._getKey(b),e=this.dbInfo.table,a=a||this._nullCallback;c&&c.transaction(function(b){b?b.executeSql("SELECT key,value FROM "+e+" WHERE key=?",[d],function(b,c){var d=[];if(c&&c.rows)for(var e=0;e<
c.rows.length;e++)d.push(c.rows.item(e));0<d.length?a(puredom.json.parse(d[0].value)):a()}):a(!1)},function(b){-1<b.message.indexOf("no such table")?a():puredom.log("WebkitSQLite Adapter Error (load): "+b.message)})},save:function(b,a,c){var d=this._getKey(b),e=this.dbInfo.table,c=c||this._nullCallback;this._requireDatabase(b,function(g){var h,j=1,f;g?(h=function(a){puredom.log("WebkitSQLite Adapter Error (save): "+a.message)},f=function(){j-=1;0>=j&&(c&&c(!0),c=b=a=h=f=g=null)},a=puredom.json.stringify(a),
g.transaction(function(b){b.executeSql("INSERT OR REPLACE INTO "+e+" (key,value) VALUES(?,?)",[d,a],f)},h)):(c(!1),c=null)})},_getDatabase:function(){var b=this.dbInfo.quota,a;if(this._currentDb)return this._currentDb;for(;!a&&b>this.dbInfo.minimumQuota;){try{a=openDatabase(this.dbInfo.name,this.dbInfo.version,this.dbInfo.displayName,b)}catch(c){}a||(b/=10)}a?this._currentDb=a:puredom.log("LocalStorage ERROR: WebkitSQLite Adapter failed to open database.");return a||!1},_requireDatabase:function(b,
a){var c=this,d=this._getDatabase(b),a=a||this._nullCallback;d?c._createTable(d,function(){a(d);c=a=b=d=null}):(a(d,!1),c=a=b=null)},_createTable:function(b,a){var c=this.dbInfo.table,a=a||this._nullCallback;b?b.transaction(function(d){d.executeSql("CREATE TABLE IF NOT EXISTS "+c+" (key TEXT UNIQUE, value TEXT)",[],function(){a(!0);a=b=null},function(){a(!1)})}):a(!1)},_getKey:function(b){return(b.id||this.defaultName||"")+""},_nullCallback:function(){}});
puredom.LocalStorage.addAdapter("UserData",{defaultName:"db",rating:20,test:function(){return/\bMSIE\s[1-6](\.[0-9]*)?/gim.test(navigator.userAgent+"")?!1:"undefined"!==typeof document.body.addBehavior},load:function(b,a){var c=this._getStore(this._getKey(b)),d,e;c&&(d=c.getAttribute("puredomlocalstorage"));d&&(e=puredom.json.parse(d));a&&a(e);return e},save:function(b,a,c){var b=this._getKey(b),d=this._getStore(b),e=!1;d&&"save"in d&&(void 0===a?d.removeAttribute?d.removeAttribute("puredomlocalstorage"):
d.setAttribute("puredomlocalstorage",""):d.setAttribute("puredomlocalstorage",puredom.json.stringify(a)),d.save(b),e=!0);c&&c(e);return e},_getStore:function(b){var a;if(!this.stores)this.stores={};a=this.stores[b];if(!a&&(a=this.stores[b]=document.getElementById(b),!a))a=this.stores[b]=document.createElement("span"),a.style.position="absolute",a.style.top="-100px",a.style.left="0",a.style.behavior="url('#default#userData')",document.body.appendChild(a);"true"!==a.getAttribute("data-tdlsud-loaded")&&
(a.setAttribute("data-tdlsud-loaded","true"),a.load(b));return a},_getKey:function(b){return"ieud"+(b.id||this.defaultName||"")+""}});
puredom.LocalStorage.addAdapter("LocalStorage",{defaultName:"db",rating:60,test:function(){var b="localStorage"in window&&"function"===typeof window.localStorage.hasOwnProperty,a,c=puredom.json({a:"a",b:4/3,c:!0,d:null});if(b)try{a=localStorage.__test,localStorage.__test=c,localStorage.__test!==c&&(b=!1),localStorage.__test=a,void 0===a&&delete localStorage.__test}catch(d){b=!1}return b},load:function(b,a){var c=this._getKey(b),d;localStorage.hasOwnProperty(c)&&(d=puredom.json.parse(localStorage[c]));
a&&a(d);return d},save:function(b,a,c){b=this._getKey(b);void 0===a?delete localStorage[b]:localStorage[b]=puredom.json.stringify(a);c&&c(!0);return!0},_getKey:function(b){return(b.id||this.defaultName||"")+""}});
puredom.LocalStorage.addAdapter("cookie",{defaultName:"db",rating:0,test:function(){return puredom.cookies&&puredom.cookies.get&&"cookie"in document?!0:!1},load:function(b,a){var c=puredom.cookies.get(b.id||this.defaultName),d;c&&(d=puredom.json(c));a&&a(d);return d},save:function(b,a,c){puredom.cookies.set(b.id||this.defaultName,puredom.json(a));c&&c(!0)}});